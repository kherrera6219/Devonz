import{b as r,l as f}from"./logs-DZu2vR68.js";import{a as u}from"./Button-BQzjmXH6.js";const a=typeof window<"u"?localStorage.getItem("netlify_connection"):null,n="your_netlify_access_token_here",h=a?JSON.parse(a):{user:null,token:n,stats:void 0},s=r(h),c=r(!1),l=r(!1);async function S(){if(!(s.get().user||!n))try{c.set(!0);const t=await fetch("https://api.netlify.com/api/v1/user",{headers:{Authorization:`Bearer ${n}`}});if(!t.ok)throw new Error(`Failed to connect to Netlify: ${t.statusText}`);const i={user:await t.json(),token:n};localStorage.setItem("netlify_connection",JSON.stringify(i)),y(i),await p(n)}catch(t){console.error("Error initializing Netlify connection:",t),f.logError("Failed to initialize Netlify connection",{error:t})}finally{c.set(!1)}}const y=o=>{const e={...s.get(),...o};s.set(e),typeof window<"u"&&localStorage.setItem("netlify_connection",JSON.stringify(e))};async function p(o){try{l.set(!0);const t=await fetch("https://api.netlify.com/api/v1/sites",{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to fetch sites: ${t.status}`);const e=await t.json(),i=s.get();y({...i,stats:{sites:e,totalSites:e.length}})}catch(t){console.error("Netlify API Error:",t),f.logError("Failed to fetch Netlify stats",{error:t}),u.error("Failed to fetch Netlify statistics")}finally{l.set(!1)}}export{p as f,S as i,s as n,y as u};
