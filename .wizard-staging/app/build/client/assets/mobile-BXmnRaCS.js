import{p as nt,d as sa}from"./logs-DZu2vR68.js";import{x as aa}from"./components-BmgQfFUx.js";var X={},Bt={};Bt.byteLength=la;Bt.toByteArray=ua;Bt.fromByteArray=ha;var me=[],oe=[],ia=typeof Uint8Array<"u"?Uint8Array:Array,Kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ze=0,oa=Kt.length;Ze<oa;++Ze)me[Ze]=Kt[Ze],oe[Kt.charCodeAt(Ze)]=Ze;oe[45]=62;oe[95]=63;function un(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function la(t){var e=un(t),r=e[0],n=e[1];return(r+n)*3/4-n}function ca(t,e,r){return(e+r)*3/4-r}function ua(t){var e,r=un(t),n=r[0],a=r[1],o=new ia(ca(t,n,a)),l=0,u=a>0?n-4:n,f;for(f=0;f<u;f+=4)e=oe[t.charCodeAt(f)]<<18|oe[t.charCodeAt(f+1)]<<12|oe[t.charCodeAt(f+2)]<<6|oe[t.charCodeAt(f+3)],o[l++]=e>>16&255,o[l++]=e>>8&255,o[l++]=e&255;return a===2&&(e=oe[t.charCodeAt(f)]<<2|oe[t.charCodeAt(f+1)]>>4,o[l++]=e&255),a===1&&(e=oe[t.charCodeAt(f)]<<10|oe[t.charCodeAt(f+1)]<<4|oe[t.charCodeAt(f+2)]>>2,o[l++]=e>>8&255,o[l++]=e&255),o}function da(t){return me[t>>18&63]+me[t>>12&63]+me[t>>6&63]+me[t&63]}function pa(t,e,r){for(var n,a=[],o=e;o<r;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),a.push(da(n));return a.join("")}function ha(t){for(var e,r=t.length,n=r%3,a=[],o=16383,l=0,u=r-n;l<u;l+=o)a.push(pa(t,l,l+o>u?u:l+o));return n===1?(e=t[r-1],a.push(me[e>>2]+me[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],a.push(me[e>>10]+me[e>>4&63]+me[e<<2&63]+"=")),a.join("")}var Tr={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Tr.read=function(t,e,r,n,a){var o,l,u=a*8-n-1,f=(1<<u)-1,h=f>>1,d=-7,v=r?a-1:0,g=r?-1:1,w=t[e+v];for(v+=g,o=w&(1<<-d)-1,w>>=-d,d+=u;d>0;o=o*256+t[e+v],v+=g,d-=8);for(l=o&(1<<-d)-1,o>>=-d,d+=n;d>0;l=l*256+t[e+v],v+=g,d-=8);if(o===0)o=1-h;else{if(o===f)return l?NaN:(w?-1:1)*(1/0);l=l+Math.pow(2,n),o=o-h}return(w?-1:1)*l*Math.pow(2,o-n)};Tr.write=function(t,e,r,n,a,o){var l,u,f,h=o*8-a-1,d=(1<<h)-1,v=d>>1,g=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:o-1,E=n?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,l=d):(l=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-l))<1&&(l--,f*=2),l+v>=1?e+=g/f:e+=g*Math.pow(2,1-v),e*f>=2&&(l++,f/=2),l+v>=d?(u=0,l=d):l+v>=1?(u=(e*f-1)*Math.pow(2,a),l=l+v):(u=e*Math.pow(2,v-1)*Math.pow(2,a),l=0));a>=8;t[r+w]=u&255,w+=E,u/=256,a-=8);for(l=l<<a|u,h+=a;h>0;t[r+w]=l&255,w+=E,l/=256,h-=8);t[r+w-E]|=x*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Bt,r=Tr,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=d,t.SlowBuffer=U,t.INSPECT_MAX_BYTES=50;const a=2147483647;t.kMaxLength=a;const{Uint8Array:o,ArrayBuffer:l,SharedArrayBuffer:u}=globalThis;d.TYPED_ARRAY_SUPPORT=f(),!d.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{const c=new o(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,o.prototype),Object.setPrototypeOf(c,s),c.foo()===42}catch{return!1}}Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}});function h(c){if(c>a)throw new RangeError('The value "'+c+'" is invalid for option "size"');const s=new o(c);return Object.setPrototypeOf(s,d.prototype),s}function d(c,s,i){if(typeof c=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return E(c)}return v(c,s,i)}d.poolSize=8192;function v(c,s,i){if(typeof c=="string")return x(c,s);if(l.isView(c))return $(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(pe(c,l)||c&&pe(c.buffer,l)||typeof u<"u"&&(pe(c,u)||c&&pe(c.buffer,u)))return B(c,s,i);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const p=c.valueOf&&c.valueOf();if(p!=null&&p!==c)return d.from(p,s,i);const m=D(c);if(m)return m;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return d.from(c[Symbol.toPrimitive]("string"),s,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}d.from=function(c,s,i){return v(c,s,i)},Object.setPrototypeOf(d.prototype,o.prototype),Object.setPrototypeOf(d,o);function g(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function w(c,s,i){return g(c),c<=0?h(c):s!==void 0?typeof i=="string"?h(c).fill(s,i):h(c).fill(s):h(c)}d.alloc=function(c,s,i){return w(c,s,i)};function E(c){return g(c),h(c<0?0:H(c)|0)}d.allocUnsafe=function(c){return E(c)},d.allocUnsafeSlow=function(c){return E(c)};function x(c,s){if((typeof s!="string"||s==="")&&(s="utf8"),!d.isEncoding(s))throw new TypeError("Unknown encoding: "+s);const i=ue(c,s)|0;let p=h(i);const m=p.write(c,s);return m!==i&&(p=p.slice(0,m)),p}function b(c){const s=c.length<0?0:H(c.length)|0,i=h(s);for(let p=0;p<s;p+=1)i[p]=c[p]&255;return i}function $(c){if(pe(c,o)){const s=new o(c);return B(s.buffer,s.byteOffset,s.byteLength)}return b(c)}function B(c,s,i){if(s<0||c.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<s+(i||0))throw new RangeError('"length" is outside of buffer bounds');let p;return s===void 0&&i===void 0?p=new o(c):i===void 0?p=new o(c,s):p=new o(c,s,i),Object.setPrototypeOf(p,d.prototype),p}function D(c){if(d.isBuffer(c)){const s=H(c.length)|0,i=h(s);return i.length===0||c.copy(i,0,0,s),i}if(c.length!==void 0)return typeof c.length!="number"||Vt(c.length)?h(0):b(c);if(c.type==="Buffer"&&Array.isArray(c.data))return b(c.data)}function H(c){if(c>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return c|0}function U(c){return+c!=c&&(c=0),d.alloc(+c)}d.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==d.prototype},d.compare=function(s,i){if(pe(s,o)&&(s=d.from(s,s.offset,s.byteLength)),pe(i,o)&&(i=d.from(i,i.offset,i.byteLength)),!d.isBuffer(s)||!d.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===i)return 0;let p=s.length,m=i.length;for(let y=0,_=Math.min(p,m);y<_;++y)if(s[y]!==i[y]){p=s[y],m=i[y];break}return p<m?-1:m<p?1:0},d.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(s,i){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return d.alloc(0);let p;if(i===void 0)for(i=0,p=0;p<s.length;++p)i+=s[p].length;const m=d.allocUnsafe(i);let y=0;for(p=0;p<s.length;++p){let _=s[p];if(pe(_,o))y+_.length>m.length?(d.isBuffer(_)||(_=d.from(_)),_.copy(m,y)):o.prototype.set.call(m,_,y);else if(d.isBuffer(_))_.copy(m,y);else throw new TypeError('"list" argument must be an Array of Buffers');y+=_.length}return m};function ue(c,s){if(d.isBuffer(c))return c.length;if(l.isView(c)||pe(c,l))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);const i=c.length,p=arguments.length>2&&arguments[2]===!0;if(!p&&i===0)return 0;let m=!1;for(;;)switch(s){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return Dt(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return Fr(c).length;default:if(m)return p?-1:Dt(c).length;s=(""+s).toLowerCase(),m=!0}}d.byteLength=ue;function L(c,s,i){let p=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,s>>>=0,i<=s))return"";for(c||(c="utf8");;)switch(c){case"hex":return K(this,s,i);case"utf8":case"utf-8":return De(this,s,i);case"ascii":return ve(this,s,i);case"latin1":case"binary":return ee(this,s,i);case"base64":return Oe(this,s,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ws(this,s,i);default:if(p)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),p=!0}}d.prototype._isBuffer=!0;function re(c,s,i){const p=c[s];c[s]=c[i],c[i]=p}d.prototype.swap16=function(){const s=this.length;if(s%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let i=0;i<s;i+=2)re(this,i,i+1);return this},d.prototype.swap32=function(){const s=this.length;if(s%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let i=0;i<s;i+=4)re(this,i,i+3),re(this,i+1,i+2);return this},d.prototype.swap64=function(){const s=this.length;if(s%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let i=0;i<s;i+=8)re(this,i,i+7),re(this,i+1,i+6),re(this,i+2,i+5),re(this,i+3,i+4);return this},d.prototype.toString=function(){const s=this.length;return s===0?"":arguments.length===0?De(this,0,s):L.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(s){if(!d.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s?!0:d.compare(this,s)===0},d.prototype.inspect=function(){let s="";const i=t.INSPECT_MAX_BYTES;return s=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(s+=" ... "),"<Buffer "+s+">"},n&&(d.prototype[n]=d.prototype.inspect),d.prototype.compare=function(s,i,p,m,y){if(pe(s,o)&&(s=d.from(s,s.offset,s.byteLength)),!d.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(i===void 0&&(i=0),p===void 0&&(p=s?s.length:0),m===void 0&&(m=0),y===void 0&&(y=this.length),i<0||p>s.length||m<0||y>this.length)throw new RangeError("out of range index");if(m>=y&&i>=p)return 0;if(m>=y)return-1;if(i>=p)return 1;if(i>>>=0,p>>>=0,m>>>=0,y>>>=0,this===s)return 0;let _=y-m,M=p-i;const J=Math.min(_,M),q=this.slice(m,y),G=s.slice(i,p);for(let V=0;V<J;++V)if(q[V]!==G[V]){_=q[V],M=G[V];break}return _<M?-1:M<_?1:0};function $e(c,s,i,p,m){if(c.length===0)return-1;if(typeof i=="string"?(p=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,Vt(i)&&(i=m?0:c.length-1),i<0&&(i=c.length+i),i>=c.length){if(m)return-1;i=c.length-1}else if(i<0)if(m)i=0;else return-1;if(typeof s=="string"&&(s=d.from(s,p)),d.isBuffer(s))return s.length===0?-1:Re(c,s,i,p,m);if(typeof s=="number")return s=s&255,typeof o.prototype.indexOf=="function"?m?o.prototype.indexOf.call(c,s,i):o.prototype.lastIndexOf.call(c,s,i):Re(c,[s],i,p,m);throw new TypeError("val must be string, number or Buffer")}function Re(c,s,i,p,m){let y=1,_=c.length,M=s.length;if(p!==void 0&&(p=String(p).toLowerCase(),p==="ucs2"||p==="ucs-2"||p==="utf16le"||p==="utf-16le")){if(c.length<2||s.length<2)return-1;y=2,_/=2,M/=2,i/=2}function J(G,V){return y===1?G[V]:G.readUInt16BE(V*y)}let q;if(m){let G=-1;for(q=i;q<_;q++)if(J(c,q)===J(s,G===-1?0:q-G)){if(G===-1&&(G=q),q-G+1===M)return G*y}else G!==-1&&(q-=q-G),G=-1}else for(i+M>_&&(i=_-M),q=i;q>=0;q--){let G=!0;for(let V=0;V<M;V++)if(J(c,q+V)!==J(s,V)){G=!1;break}if(G)return q}return-1}d.prototype.includes=function(s,i,p){return this.indexOf(s,i,p)!==-1},d.prototype.indexOf=function(s,i,p){return $e(this,s,i,p,!0)},d.prototype.lastIndexOf=function(s,i,p){return $e(this,s,i,p,!1)};function Ue(c,s,i,p){i=Number(i)||0;const m=c.length-i;p?(p=Number(p),p>m&&(p=m)):p=m;const y=s.length;p>y/2&&(p=y/2);let _;for(_=0;_<p;++_){const M=parseInt(s.substr(_*2,2),16);if(Vt(M))return _;c[i+_]=M}return _}function Le(c,s,i,p){return lt(Dt(s,c.length-i),c,i,p)}function ot(c,s,i,p){return lt(ea(s),c,i,p)}function Ie(c,s,i,p){return lt(Fr(s),c,i,p)}function de(c,s,i,p){return lt(ta(s,c.length-i),c,i,p)}d.prototype.write=function(s,i,p,m){if(i===void 0)m="utf8",p=this.length,i=0;else if(p===void 0&&typeof i=="string")m=i,p=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(p)?(p=p>>>0,m===void 0&&(m="utf8")):(m=p,p=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const y=this.length-i;if((p===void 0||p>y)&&(p=y),s.length>0&&(p<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");m||(m="utf8");let _=!1;for(;;)switch(m){case"hex":return Ue(this,s,i,p);case"utf8":case"utf-8":return Le(this,s,i,p);case"ascii":case"latin1":case"binary":return ot(this,s,i,p);case"base64":return Ie(this,s,i,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return de(this,s,i,p);default:if(_)throw new TypeError("Unknown encoding: "+m);m=(""+m).toLowerCase(),_=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Oe(c,s,i){return s===0&&i===c.length?e.fromByteArray(c):e.fromByteArray(c.slice(s,i))}function De(c,s,i){i=Math.min(c.length,i);const p=[];let m=s;for(;m<i;){const y=c[m];let _=null,M=y>239?4:y>223?3:y>191?2:1;if(m+M<=i){let J,q,G,V;switch(M){case 1:y<128&&(_=y);break;case 2:J=c[m+1],(J&192)===128&&(V=(y&31)<<6|J&63,V>127&&(_=V));break;case 3:J=c[m+1],q=c[m+2],(J&192)===128&&(q&192)===128&&(V=(y&15)<<12|(J&63)<<6|q&63,V>2047&&(V<55296||V>57343)&&(_=V));break;case 4:J=c[m+1],q=c[m+2],G=c[m+3],(J&192)===128&&(q&192)===128&&(G&192)===128&&(V=(y&15)<<18|(J&63)<<12|(q&63)<<6|G&63,V>65535&&V<1114112&&(_=V))}}_===null?(_=65533,M=1):_>65535&&(_-=65536,p.push(_>>>10&1023|55296),_=56320|_&1023),p.push(_),m+=M}return Q(p)}const Xe=4096;function Q(c){const s=c.length;if(s<=Xe)return String.fromCharCode.apply(String,c);let i="",p=0;for(;p<s;)i+=String.fromCharCode.apply(String,c.slice(p,p+=Xe));return i}function ve(c,s,i){let p="";i=Math.min(c.length,i);for(let m=s;m<i;++m)p+=String.fromCharCode(c[m]&127);return p}function ee(c,s,i){let p="";i=Math.min(c.length,i);for(let m=s;m<i;++m)p+=String.fromCharCode(c[m]);return p}function K(c,s,i){const p=c.length;(!s||s<0)&&(s=0),(!i||i<0||i>p)&&(i=p);let m="";for(let y=s;y<i;++y)m+=ra[c[y]];return m}function Ws(c,s,i){const p=c.slice(s,i);let m="";for(let y=0;y<p.length-1;y+=2)m+=String.fromCharCode(p[y]+p[y+1]*256);return m}d.prototype.slice=function(s,i){const p=this.length;s=~~s,i=i===void 0?p:~~i,s<0?(s+=p,s<0&&(s=0)):s>p&&(s=p),i<0?(i+=p,i<0&&(i=0)):i>p&&(i=p),i<s&&(i=s);const m=this.subarray(s,i);return Object.setPrototypeOf(m,d.prototype),m};function te(c,s,i){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+s>i)throw new RangeError("Trying to access beyond buffer length")}d.prototype.readUintLE=d.prototype.readUIntLE=function(s,i,p){s=s>>>0,i=i>>>0,p||te(s,i,this.length);let m=this[s],y=1,_=0;for(;++_<i&&(y*=256);)m+=this[s+_]*y;return m},d.prototype.readUintBE=d.prototype.readUIntBE=function(s,i,p){s=s>>>0,i=i>>>0,p||te(s,i,this.length);let m=this[s+--i],y=1;for(;i>0&&(y*=256);)m+=this[s+--i]*y;return m},d.prototype.readUint8=d.prototype.readUInt8=function(s,i){return s=s>>>0,i||te(s,1,this.length),this[s]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(s,i){return s=s>>>0,i||te(s,2,this.length),this[s]|this[s+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(s,i){return s=s>>>0,i||te(s,2,this.length),this[s]<<8|this[s+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(s,i){return s=s>>>0,i||te(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+this[s+3]*16777216},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(s,i){return s=s>>>0,i||te(s,4,this.length),this[s]*16777216+(this[s+1]<<16|this[s+2]<<8|this[s+3])},d.prototype.readBigUInt64LE=Ae(function(s){s=s>>>0,Ke(s,"offset");const i=this[s],p=this[s+7];(i===void 0||p===void 0)&&Qe(s,this.length-8);const m=i+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24,y=this[++s]+this[++s]*2**8+this[++s]*2**16+p*2**24;return BigInt(m)+(BigInt(y)<<BigInt(32))}),d.prototype.readBigUInt64BE=Ae(function(s){s=s>>>0,Ke(s,"offset");const i=this[s],p=this[s+7];(i===void 0||p===void 0)&&Qe(s,this.length-8);const m=i*2**24+this[++s]*2**16+this[++s]*2**8+this[++s],y=this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+p;return(BigInt(m)<<BigInt(32))+BigInt(y)}),d.prototype.readIntLE=function(s,i,p){s=s>>>0,i=i>>>0,p||te(s,i,this.length);let m=this[s],y=1,_=0;for(;++_<i&&(y*=256);)m+=this[s+_]*y;return y*=128,m>=y&&(m-=Math.pow(2,8*i)),m},d.prototype.readIntBE=function(s,i,p){s=s>>>0,i=i>>>0,p||te(s,i,this.length);let m=i,y=1,_=this[s+--m];for(;m>0&&(y*=256);)_+=this[s+--m]*y;return y*=128,_>=y&&(_-=Math.pow(2,8*i)),_},d.prototype.readInt8=function(s,i){return s=s>>>0,i||te(s,1,this.length),this[s]&128?(255-this[s]+1)*-1:this[s]},d.prototype.readInt16LE=function(s,i){s=s>>>0,i||te(s,2,this.length);const p=this[s]|this[s+1]<<8;return p&32768?p|4294901760:p},d.prototype.readInt16BE=function(s,i){s=s>>>0,i||te(s,2,this.length);const p=this[s+1]|this[s]<<8;return p&32768?p|4294901760:p},d.prototype.readInt32LE=function(s,i){return s=s>>>0,i||te(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},d.prototype.readInt32BE=function(s,i){return s=s>>>0,i||te(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},d.prototype.readBigInt64LE=Ae(function(s){s=s>>>0,Ke(s,"offset");const i=this[s],p=this[s+7];(i===void 0||p===void 0)&&Qe(s,this.length-8);const m=this[s+4]+this[s+5]*2**8+this[s+6]*2**16+(p<<24);return(BigInt(m)<<BigInt(32))+BigInt(i+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24)}),d.prototype.readBigInt64BE=Ae(function(s){s=s>>>0,Ke(s,"offset");const i=this[s],p=this[s+7];(i===void 0||p===void 0)&&Qe(s,this.length-8);const m=(i<<24)+this[++s]*2**16+this[++s]*2**8+this[++s];return(BigInt(m)<<BigInt(32))+BigInt(this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+p)}),d.prototype.readFloatLE=function(s,i){return s=s>>>0,i||te(s,4,this.length),r.read(this,s,!0,23,4)},d.prototype.readFloatBE=function(s,i){return s=s>>>0,i||te(s,4,this.length),r.read(this,s,!1,23,4)},d.prototype.readDoubleLE=function(s,i){return s=s>>>0,i||te(s,8,this.length),r.read(this,s,!0,52,8)},d.prototype.readDoubleBE=function(s,i){return s=s>>>0,i||te(s,8,this.length),r.read(this,s,!1,52,8)};function se(c,s,i,p,m,y){if(!d.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>m||s<y)throw new RangeError('"value" argument is out of bounds');if(i+p>c.length)throw new RangeError("Index out of range")}d.prototype.writeUintLE=d.prototype.writeUIntLE=function(s,i,p,m){if(s=+s,i=i>>>0,p=p>>>0,!m){const M=Math.pow(2,8*p)-1;se(this,s,i,p,M,0)}let y=1,_=0;for(this[i]=s&255;++_<p&&(y*=256);)this[i+_]=s/y&255;return i+p},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(s,i,p,m){if(s=+s,i=i>>>0,p=p>>>0,!m){const M=Math.pow(2,8*p)-1;se(this,s,i,p,M,0)}let y=p-1,_=1;for(this[i+y]=s&255;--y>=0&&(_*=256);)this[i+y]=s/_&255;return i+p},d.prototype.writeUint8=d.prototype.writeUInt8=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,1,255,0),this[i]=s&255,i+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,2,65535,0),this[i]=s&255,this[i+1]=s>>>8,i+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,2,65535,0),this[i]=s>>>8,this[i+1]=s&255,i+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,4,4294967295,0),this[i+3]=s>>>24,this[i+2]=s>>>16,this[i+1]=s>>>8,this[i]=s&255,i+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,4,4294967295,0),this[i]=s>>>24,this[i+1]=s>>>16,this[i+2]=s>>>8,this[i+3]=s&255,i+4};function Rr(c,s,i,p,m){jr(s,p,m,c,i,7);let y=Number(s&BigInt(4294967295));c[i++]=y,y=y>>8,c[i++]=y,y=y>>8,c[i++]=y,y=y>>8,c[i++]=y;let _=Number(s>>BigInt(32)&BigInt(4294967295));return c[i++]=_,_=_>>8,c[i++]=_,_=_>>8,c[i++]=_,_=_>>8,c[i++]=_,i}function Or(c,s,i,p,m){jr(s,p,m,c,i,7);let y=Number(s&BigInt(4294967295));c[i+7]=y,y=y>>8,c[i+6]=y,y=y>>8,c[i+5]=y,y=y>>8,c[i+4]=y;let _=Number(s>>BigInt(32)&BigInt(4294967295));return c[i+3]=_,_=_>>8,c[i+2]=_,_=_>>8,c[i+1]=_,_=_>>8,c[i]=_,i+8}d.prototype.writeBigUInt64LE=Ae(function(s,i=0){return Rr(this,s,i,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeBigUInt64BE=Ae(function(s,i=0){return Or(this,s,i,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeIntLE=function(s,i,p,m){if(s=+s,i=i>>>0,!m){const J=Math.pow(2,8*p-1);se(this,s,i,p,J-1,-J)}let y=0,_=1,M=0;for(this[i]=s&255;++y<p&&(_*=256);)s<0&&M===0&&this[i+y-1]!==0&&(M=1),this[i+y]=(s/_>>0)-M&255;return i+p},d.prototype.writeIntBE=function(s,i,p,m){if(s=+s,i=i>>>0,!m){const J=Math.pow(2,8*p-1);se(this,s,i,p,J-1,-J)}let y=p-1,_=1,M=0;for(this[i+y]=s&255;--y>=0&&(_*=256);)s<0&&M===0&&this[i+y+1]!==0&&(M=1),this[i+y]=(s/_>>0)-M&255;return i+p},d.prototype.writeInt8=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,1,127,-128),s<0&&(s=255+s+1),this[i]=s&255,i+1},d.prototype.writeInt16LE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,2,32767,-32768),this[i]=s&255,this[i+1]=s>>>8,i+2},d.prototype.writeInt16BE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,2,32767,-32768),this[i]=s>>>8,this[i+1]=s&255,i+2},d.prototype.writeInt32LE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,4,2147483647,-2147483648),this[i]=s&255,this[i+1]=s>>>8,this[i+2]=s>>>16,this[i+3]=s>>>24,i+4},d.prototype.writeInt32BE=function(s,i,p){return s=+s,i=i>>>0,p||se(this,s,i,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[i]=s>>>24,this[i+1]=s>>>16,this[i+2]=s>>>8,this[i+3]=s&255,i+4},d.prototype.writeBigInt64LE=Ae(function(s,i=0){return Rr(this,s,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),d.prototype.writeBigInt64BE=Ae(function(s,i=0){return Or(this,s,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Br(c,s,i,p,m,y){if(i+p>c.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function Nr(c,s,i,p,m){return s=+s,i=i>>>0,m||Br(c,s,i,4),r.write(c,s,i,p,23,4),i+4}d.prototype.writeFloatLE=function(s,i,p){return Nr(this,s,i,!0,p)},d.prototype.writeFloatBE=function(s,i,p){return Nr(this,s,i,!1,p)};function Pr(c,s,i,p,m){return s=+s,i=i>>>0,m||Br(c,s,i,8),r.write(c,s,i,p,52,8),i+8}d.prototype.writeDoubleLE=function(s,i,p){return Pr(this,s,i,!0,p)},d.prototype.writeDoubleBE=function(s,i,p){return Pr(this,s,i,!1,p)},d.prototype.copy=function(s,i,p,m){if(!d.isBuffer(s))throw new TypeError("argument should be a Buffer");if(p||(p=0),!m&&m!==0&&(m=this.length),i>=s.length&&(i=s.length),i||(i=0),m>0&&m<p&&(m=p),m===p||s.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(p<0||p>=this.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("sourceEnd out of bounds");m>this.length&&(m=this.length),s.length-i<m-p&&(m=s.length-i+p);const y=m-p;return this===s&&typeof o.prototype.copyWithin=="function"?this.copyWithin(i,p,m):o.prototype.set.call(s,this.subarray(p,m),i),y},d.prototype.fill=function(s,i,p,m){if(typeof s=="string"){if(typeof i=="string"?(m=i,i=0,p=this.length):typeof p=="string"&&(m=p,p=this.length),m!==void 0&&typeof m!="string")throw new TypeError("encoding must be a string");if(typeof m=="string"&&!d.isEncoding(m))throw new TypeError("Unknown encoding: "+m);if(s.length===1){const _=s.charCodeAt(0);(m==="utf8"&&_<128||m==="latin1")&&(s=_)}}else typeof s=="number"?s=s&255:typeof s=="boolean"&&(s=Number(s));if(i<0||this.length<i||this.length<p)throw new RangeError("Out of range index");if(p<=i)return this;i=i>>>0,p=p===void 0?this.length:p>>>0,s||(s=0);let y;if(typeof s=="number")for(y=i;y<p;++y)this[y]=s;else{const _=d.isBuffer(s)?s:d.from(s,m),M=_.length;if(M===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(y=0;y<p-i;++y)this[y+i]=_[y%M]}return this};const Ve={};function Lt(c,s,i){Ve[c]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:s.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${c}]`,this.stack,delete this.name}get code(){return c}set code(m){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:m,writable:!0})}toString(){return`${this.name} [${c}]: ${this.message}`}}}Lt("ERR_BUFFER_OUT_OF_BOUNDS",function(c){return c?`${c} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Lt("ERR_INVALID_ARG_TYPE",function(c,s){return`The "${c}" argument must be of type number. Received type ${typeof s}`},TypeError),Lt("ERR_OUT_OF_RANGE",function(c,s,i){let p=`The value of "${c}" is out of range.`,m=i;return Number.isInteger(i)&&Math.abs(i)>2**32?m=Mr(String(i)):typeof i=="bigint"&&(m=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(m=Mr(m)),m+="n"),p+=` It must be ${s}. Received ${m}`,p},RangeError);function Mr(c){let s="",i=c.length;const p=c[0]==="-"?1:0;for(;i>=p+4;i-=3)s=`_${c.slice(i-3,i)}${s}`;return`${c.slice(0,i)}${s}`}function Ys(c,s,i){Ke(s,"offset"),(c[s]===void 0||c[s+i]===void 0)&&Qe(s,c.length-(i+1))}function jr(c,s,i,p,m,y){if(c>i||c<s){const _=typeof s=="bigint"?"n":"";let M;throw s===0||s===BigInt(0)?M=`>= 0${_} and < 2${_} ** ${(y+1)*8}${_}`:M=`>= -(2${_} ** ${(y+1)*8-1}${_}) and < 2 ** ${(y+1)*8-1}${_}`,new Ve.ERR_OUT_OF_RANGE("value",M,c)}Ys(p,m,y)}function Ke(c,s){if(typeof c!="number")throw new Ve.ERR_INVALID_ARG_TYPE(s,"number",c)}function Qe(c,s,i){throw Math.floor(c)!==c?(Ke(c,i),new Ve.ERR_OUT_OF_RANGE("offset","an integer",c)):s<0?new Ve.ERR_BUFFER_OUT_OF_BOUNDS:new Ve.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${s}`,c)}const Xs=/[^+/0-9A-Za-z-_]/g;function Qs(c){if(c=c.split("=")[0],c=c.trim().replace(Xs,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function Dt(c,s){s=s||1/0;let i;const p=c.length;let m=null;const y=[];for(let _=0;_<p;++_){if(i=c.charCodeAt(_),i>55295&&i<57344){if(!m){if(i>56319){(s-=3)>-1&&y.push(239,191,189);continue}else if(_+1===p){(s-=3)>-1&&y.push(239,191,189);continue}m=i;continue}if(i<56320){(s-=3)>-1&&y.push(239,191,189),m=i;continue}i=(m-55296<<10|i-56320)+65536}else m&&(s-=3)>-1&&y.push(239,191,189);if(m=null,i<128){if((s-=1)<0)break;y.push(i)}else if(i<2048){if((s-=2)<0)break;y.push(i>>6|192,i&63|128)}else if(i<65536){if((s-=3)<0)break;y.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((s-=4)<0)break;y.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return y}function ea(c){const s=[];for(let i=0;i<c.length;++i)s.push(c.charCodeAt(i)&255);return s}function ta(c,s){let i,p,m;const y=[];for(let _=0;_<c.length&&!((s-=2)<0);++_)i=c.charCodeAt(_),p=i>>8,m=i%256,y.push(m),y.push(p);return y}function Fr(c){return e.toByteArray(Qs(c))}function lt(c,s,i,p){let m;for(m=0;m<p&&!(m+i>=s.length||m>=c.length);++m)s[m+i]=c[m];return m}function pe(c,s){return c instanceof s||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===s.name}function Vt(c){return c!==c}const ra=function(){const c="0123456789abcdef",s=new Array(256);for(let i=0;i<16;++i){const p=i*16;for(let m=0;m<16;++m)s[p+m]=c[i]+c[m]}return s}();function Ae(c){return typeof BigInt>"u"?na:c}function na(){throw new Error("BigInt not supported")}})(X);const Ir=X.Buffer,fa=X.Blob,ma=X.BlobOptions,ga=X.Buffer,ya=X.File,va=X.FileOptions,_a=X.INSPECT_MAX_BYTES,wa=X.SlowBuffer,xa=X.TranscodeEncoding,ba=X.atob,ka=X.btoa,Ea=X.constants,Ta=X.isAscii,Ia=X.isUtf8,Aa=X.kMaxLength,Ca=X.kStringMaxLength,Sa=X.resolveObjectURL,$a=X.transcode,jl=Object.freeze(Object.defineProperty({__proto__:null,Blob:fa,BlobOptions:ma,Buffer:ga,File:ya,FileOptions:va,INSPECT_MAX_BYTES:_a,SlowBuffer:wa,TranscodeEncoding:xa,atob:ba,btoa:ka,constants:Ea,default:Ir,isAscii:Ta,isUtf8:Ia,kMaxLength:Aa,kStringMaxLength:Ca,resolveObjectURL:Sa,transcode:$a},Symbol.toStringTag,{value:"Module"}));var dn="vercel.ai.error",Ra=Symbol.for(dn),pn,Oa=class hn extends Error{constructor({name:e,message:r,cause:n}){super(r),this[pn]=!0,this.name=e,this.cause=n}static isInstance(e){return hn.hasMarker(e,dn)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}};pn=Ra;var W=Oa,fn="AI_APICallError",mn=`vercel.ai.error.${fn}`,Ba=Symbol.for(mn),gn,we=class extends W{constructor({message:e,url:r,requestBodyValues:n,statusCode:a,responseHeaders:o,responseBody:l,cause:u,isRetryable:f=a!=null&&(a===408||a===409||a===429||a>=500),data:h}){super({name:fn,message:e,cause:u}),this[gn]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=a,this.responseHeaders=o,this.responseBody=l,this.isRetryable=f,this.data=h}static isInstance(e){return W.hasMarker(e,mn)}};gn=Ba;var yn="AI_EmptyResponseBodyError",vn=`vercel.ai.error.${yn}`,Na=Symbol.for(vn),_n,Pa=class extends W{constructor({message:e="Empty response body"}={}){super({name:yn,message:e}),this[_n]=!0}static isInstance(e){return W.hasMarker(e,vn)}};_n=Na;function wn(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var xn="AI_InvalidArgumentError",bn=`vercel.ai.error.${xn}`,Ma=Symbol.for(bn),kn,ja=class extends W{constructor({message:t,cause:e,argument:r}){super({name:xn,message:t,cause:e}),this[kn]=!0,this.argument=r}static isInstance(t){return W.hasMarker(t,bn)}};kn=Ma;var En="AI_InvalidPromptError",Tn=`vercel.ai.error.${En}`,Fa=Symbol.for(Tn),In,Ua=class extends W{constructor({prompt:t,message:e,cause:r}){super({name:En,message:`Invalid prompt: ${e}`,cause:r}),this[In]=!0,this.prompt=t}static isInstance(t){return W.hasMarker(t,Tn)}};In=Fa;var An="AI_InvalidResponseDataError",Cn=`vercel.ai.error.${An}`,La=Symbol.for(Cn),Sn,Zt=class extends W{constructor({data:t,message:e=`Invalid response data: ${JSON.stringify(t)}.`}){super({name:An,message:e}),this[Sn]=!0,this.data=t}static isInstance(t){return W.hasMarker(t,Cn)}};Sn=La;var $n="AI_JSONParseError",Rn=`vercel.ai.error.${$n}`,Da=Symbol.for(Rn),On,ht=class extends W{constructor({text:e,cause:r}){super({name:$n,message:`JSON parsing failed: Text: ${e}.
Error message: ${wn(r)}`,cause:r}),this[On]=!0,this.text=e}static isInstance(e){return W.hasMarker(e,Rn)}};On=Da;var Bn="AI_LoadAPIKeyError",Nn=`vercel.ai.error.${Bn}`,Va=Symbol.for(Nn),Pn,ct=class extends W{constructor({message:e}){super({name:Bn,message:e}),this[Pn]=!0}static isInstance(e){return W.hasMarker(e,Nn)}};Pn=Va;var Mn="AI_TooManyEmbeddingValuesForCallError",jn=`vercel.ai.error.${Mn}`,Ka=Symbol.for(jn),Fn,Za=class extends W{constructor(e){super({name:Mn,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[Fn]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return W.hasMarker(e,jn)}};Fn=Ka;var Un="AI_TypeValidationError",Ln=`vercel.ai.error.${Un}`,qa=Symbol.for(Ln),Dn,Ha=class Yt extends W{constructor({value:e,cause:r}){super({name:Un,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${wn(r)}`,cause:r}),this[Dn]=!0,this.value=e}static isInstance(e){return W.hasMarker(e,Ln)}static wrap({value:e,cause:r}){return Yt.isInstance(r)&&r.value===e?r:new Yt({value:e,cause:r})}};Dn=qa;var ft=Ha,Vn="AI_UnsupportedFunctionalityError",Kn=`vercel.ai.error.${Vn}`,Ja=Symbol.for(Kn),Zn,ae=class extends W{constructor({functionality:e,message:r=`'${e}' functionality not supported.`}){super({name:Vn,message:r}),this[Zn]=!0,this.functionality=e}static isInstance(e){return W.hasMarker(e,Kn)}};Zn=Ja;let Ga=(t,e=21)=>(r=e)=>{let n="",a=r|0;for(;a--;)n+=t[Math.random()*t.length|0];return n};var Ye={exports:{}};const za=typeof Ir<"u",Ur=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,Lr=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function qn(t,e,r){r==null&&e!==null&&typeof e=="object"&&(r=e,e=void 0),za&&Ir.isBuffer(t)&&(t=t.toString()),t&&t.charCodeAt(0)===65279&&(t=t.slice(1));const n=JSON.parse(t,e);if(n===null||typeof n!="object")return n;const a=r&&r.protoAction||"error",o=r&&r.constructorAction||"error";if(a==="ignore"&&o==="ignore")return n;if(a!=="ignore"&&o!=="ignore"){if(Ur.test(t)===!1&&Lr.test(t)===!1)return n}else if(a!=="ignore"&&o==="ignore"){if(Ur.test(t)===!1)return n}else if(Lr.test(t)===!1)return n;return Hn(n,{protoAction:a,constructorAction:o,safe:r&&r.safe})}function Hn(t,{protoAction:e="error",constructorAction:r="error",safe:n}={}){let a=[t];for(;a.length;){const o=a;a=[];for(const l of o){if(e!=="ignore"&&Object.prototype.hasOwnProperty.call(l,"__proto__")){if(n===!0)return null;if(e==="error")throw new SyntaxError("Object contains forbidden prototype property");delete l.__proto__}if(r!=="ignore"&&Object.prototype.hasOwnProperty.call(l,"constructor")&&Object.prototype.hasOwnProperty.call(l.constructor,"prototype")){if(n===!0)return null;if(r==="error")throw new SyntaxError("Object contains forbidden prototype property");delete l.constructor}for(const u in l){const f=l[u];f&&typeof f=="object"&&a.push(f)}}}return t}function Ar(t,e,r){const n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return qn(t,e,r)}finally{Error.stackTraceLimit=n}}function Wa(t,e){const r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return qn(t,e,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=r}}Ye.exports=Ar;Ye.exports.default=Ar;Ye.exports.parse=Ar;Ye.exports.safeParse=Wa;Ye.exports.scan=Hn;var Ya=Ye.exports;const Fe=aa(Ya);class Dr extends Error{constructor(e,r){super(e),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}}function qt(t){}function Xa(t){if(typeof t=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:e=qt,onError:r=qt,onRetry:n=qt,onComment:a}=t;let o="",l=!0,u,f="",h="";function d(x){const b=l?x.replace(/^\xEF\xBB\xBF/,""):x,[$,B]=Qa(`${o}${b}`);for(const D of $)v(D);o=B,l=!1}function v(x){if(x===""){w();return}if(x.startsWith(":")){a&&a(x.slice(x.startsWith(": ")?2:1));return}const b=x.indexOf(":");if(b!==-1){const $=x.slice(0,b),B=x[b+1]===" "?2:1,D=x.slice(b+B);g($,D,x);return}g(x,"",x)}function g(x,b,$){switch(x){case"event":h=b;break;case"data":f=`${f}${b}
`;break;case"id":u=b.includes("\0")?void 0:b;break;case"retry":/^\d+$/.test(b)?n(parseInt(b,10)):r(new Dr(`Invalid \`retry\` value: "${b}"`,{type:"invalid-retry",value:b,line:$}));break;default:r(new Dr(`Unknown field "${x.length>20?`${x.slice(0,20)}â€¦`:x}"`,{type:"unknown-field",field:x,value:b,line:$}));break}}function w(){f.length>0&&e({id:u,event:h||void 0,data:f.endsWith(`
`)?f.slice(0,-1):f}),u=void 0,f="",h=""}function E(x={}){o&&x.consume&&v(o),l=!0,u=void 0,f="",h="",o=""}return{feed:d,reset:E}}function Qa(t){const e=[];let r="",n=0;for(;n<t.length;){const a=t.indexOf("\r",n),o=t.indexOf(`
`,n);let l=-1;if(a!==-1&&o!==-1?l=Math.min(a,o):a!==-1?a===t.length-1?l=-1:l=a:o!==-1&&(l=o),l===-1){r=t.slice(n);break}else{const u=t.slice(n,l);e.push(u),n=l+1,t[n-1]==="\r"&&t[n]===`
`&&n++}}return[e,r]}let ei=class extends TransformStream{constructor({onError:e,onRetry:r,onComment:n}={}){let a;super({start(o){a=Xa({onEvent:l=>{o.enqueue(l)},onError(l){e==="terminate"?o.error(l):typeof e=="function"&&e(l)},onRetry:r,onComment:n})},transform(o){a.feed(o)}})}};var ti={};function He(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function Nt(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var ri=({prefix:t,size:e=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const a=Ga(r,e);if(t==null)return a;if(r.includes(n))throw new ja({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return o=>`${t}${n}${a(o)}`},et=ri();function Ht(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function ni({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new ct({message:`${n} API key must be a string.`});if(typeof nt>"u")throw new ct({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=ti[e],t==null)throw new ct({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new ct({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var Xt=Symbol.for("vercel.ai.validator");function si(t){return{[Xt]:!0,validate:t}}function ai(t){return typeof t=="object"&&t!==null&&Xt in t&&t[Xt]===!0&&"validate"in t}function ii(t){return ai(t)?t:oi(t)}function oi(t){return si(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function li({value:t,schema:e}){const r=Jn({value:t,schema:e});if(!r.success)throw ft.wrap({value:t,cause:r.error});return r.value}function Jn({value:t,schema:e}){const r=ii(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:ft.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:ft.wrap({value:t,cause:n})}}}function ci({text:t,schema:e}){try{const r=Fe.parse(t);return e==null?r:li({value:r,schema:e})}catch(r){throw ht.isInstance(r)||ft.isInstance(r)?r:new ht({text:t,cause:r})}}function Gn({text:t,schema:e}){try{const r=Fe.parse(t);if(e==null)return{success:!0,value:r,rawValue:r};const n=Jn({value:r,schema:e});return n.success?{...n,rawValue:r}:n}catch(r){return{success:!1,error:ht.isInstance(r)?r:new ht({text:t,cause:r})}}}function Vr(t){try{return Fe.parse(t),!0}catch{return!1}}function ui(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var di=()=>globalThis.fetch,Je=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:a,abortSignal:o,fetch:l})=>pi({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:a,abortSignal:o,fetch:l}),pi=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:a,abortSignal:o,fetch:l=di()})=>{try{const u=await l(t,{method:"POST",headers:ui(e),body:r.content,signal:o}),f=Nt(u);if(!u.ok){let h;try{h=await a({response:u,url:t,requestBodyValues:r.values})}catch(d){throw Ht(d)||we.isInstance(d)?d:new we({message:"Failed to process error response",cause:d,statusCode:u.status,url:t,responseHeaders:f,requestBodyValues:r.values})}throw h.value}try{return await n({response:u,url:t,requestBodyValues:r.values})}catch(h){throw h instanceof Error&&(Ht(h)||we.isInstance(h))?h:new we({message:"Failed to process successful response",cause:h,statusCode:u.status,url:t,responseHeaders:f,requestBodyValues:r.values})}}catch(u){if(Ht(u))throw u;if(u instanceof TypeError&&u.message==="fetch failed"){const f=u.cause;if(f!=null)throw new we({message:`Cannot connect to API: ${f.message}`,cause:f,url:t,requestBodyValues:r.values,isRetryable:!0})}throw u}},hi=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:a,requestBodyValues:o})=>{const l=await n.text(),u=Nt(n);if(l.trim()==="")return{responseHeaders:u,value:new we({message:n.statusText,url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r?.(n)})};try{const f=ci({text:l,schema:t});return{responseHeaders:u,value:new we({message:e(f),url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,data:f,isRetryable:r?.(n,f)})}}catch{return{responseHeaders:u,value:new we({message:n.statusText,url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r?.(n)})}}},zn=t=>async({response:e})=>{const r=Nt(e);if(e.body==null)throw new Pa({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new ei).pipeThrough(new TransformStream({transform({data:n},a){n!=="[DONE]"&&a.enqueue(Gn({text:n,schema:t}))}}))}},Pt=t=>async({response:e,url:r,requestBodyValues:n})=>{const a=await e.text(),o=Gn({text:a,schema:t}),l=Nt(e);if(!o.success)throw new we({message:"Invalid JSON response",cause:o.error,statusCode:e.status,responseHeaders:l,responseBody:a,url:r,requestBodyValues:n});return{responseHeaders:l,value:o.value,rawValue:o.rawValue}},{btoa:fi}=globalThis;function mi(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return fi(e)}function gi(t){return t?.replace(/\/$/,"")}var F;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function r(a){throw new Error}t.assertNever=r,t.arrayToEnum=a=>{const o={};for(const l of a)o[l]=l;return o},t.getValidEnumValues=a=>{const o=t.objectKeys(a).filter(u=>typeof a[a[u]]!="number"),l={};for(const u of o)l[u]=a[u];return t.objectValues(l)},t.objectValues=a=>t.objectKeys(a).map(function(o){return a[o]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const o=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&o.push(l);return o},t.find=(a,o)=>{for(const l of a)if(o(l))return l},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,o=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(o)}t.joinValues=n,t.jsonStringifyReplacer=(a,o)=>typeof o=="bigint"?o.toString():o})(F||(F={}));var Kr;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Kr||(Kr={}));const A=F.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ce=t=>{switch(typeof t){case"undefined":return A.undefined;case"string":return A.string;case"number":return Number.isNaN(t)?A.nan:A.number;case"boolean":return A.boolean;case"function":return A.function;case"bigint":return A.bigint;case"symbol":return A.symbol;case"object":return Array.isArray(t)?A.array:t===null?A.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?A.promise:typeof Map<"u"&&t instanceof Map?A.map:typeof Set<"u"&&t instanceof Set?A.set:typeof Date<"u"&&t instanceof Date?A.date:A.object;default:return A.unknown}},k=F.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Te extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(o){return o.message},n={_errors:[]},a=o=>{for(const l of o.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)n._errors.push(r(l));else{let u=n,f=0;for(;f<l.path.length;){const h=l.path[f];f===l.path.length-1?(u[h]=u[h]||{_errors:[]},u[h]._errors.push(r(l))):u[h]=u[h]||{_errors:[]},u=u[h],f++}}};return a(this),n}static assert(e){if(!(e instanceof Te))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,F.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const a of this.issues)if(a.path.length>0){const o=a.path[0];r[o]=r[o]||[],r[o].push(e(a))}else n.push(e(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Te.create=t=>new Te(t);const Qt=(t,e)=>{let r;switch(t.code){case k.invalid_type:t.received===A.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case k.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,F.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:r=`Unrecognized key(s) in object: ${F.joinValues(t.keys,", ")}`;break;case k.invalid_union:r="Invalid input";break;case k.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${F.joinValues(t.options)}`;break;case k.invalid_enum_value:r=`Invalid enum value. Expected ${F.joinValues(t.options)}, received '${t.received}'`;break;case k.invalid_arguments:r="Invalid function arguments";break;case k.invalid_return_type:r="Invalid function return type";break;case k.invalid_date:r="Invalid date";break;case k.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:F.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case k.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case k.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case k.custom:r="Invalid input";break;case k.invalid_intersection_types:r="Intersection results could not be merged";break;case k.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case k.not_finite:r="Number must be finite";break;default:r=e.defaultError,F.assertNever(t)}return{message:r}};let yi=Qt;function vi(){return yi}const _i=t=>{const{data:e,path:r,errorMaps:n,issueData:a}=t,o=[...r,...a.path||[]],l={...a,path:o};if(a.message!==void 0)return{...a,path:o,message:a.message};let u="";const f=n.filter(h=>!!h).slice().reverse();for(const h of f)u=h(l,{data:e,defaultError:u}).message;return{...a,path:o,message:u}};function T(t,e){const r=vi(),n=_i({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Qt?void 0:Qt].filter(a=>!!a)});t.common.issues.push(n)}class ne{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const a of r){if(a.status==="aborted")return R;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const a of r){const o=await a.key,l=await a.value;n.push({key:o,value:l})}return ne.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const a of r){const{key:o,value:l}=a;if(o.status==="aborted"||l.status==="aborted")return R;o.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(n[o.value]=l.value)}return{status:e.value,value:n}}}const R=Object.freeze({status:"aborted"}),tt=t=>({status:"dirty",value:t}),ce=t=>({status:"valid",value:t}),Zr=t=>t.status==="aborted",qr=t=>t.status==="dirty",Ge=t=>t.status==="valid",mt=t=>typeof Promise<"u"&&t instanceof Promise;var C;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(C||(C={}));class ye{constructor(e,r,n,a){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Hr=(t,e)=>{if(Ge(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Te(t.common.issues);return this._error=r,this._error}}};function P(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:a}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,u)=>{const{message:f}=t;return l.code==="invalid_enum_value"?{message:f??u.defaultError}:typeof u.data>"u"?{message:f??n??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:f??r??u.defaultError}},description:a}}class j{get description(){return this._def.description}_getType(e){return Ce(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ce(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ne,ctx:{common:e.parent.common,data:e.data,parsedType:Ce(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(mt(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){const n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ce(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Hr(n,a)}"~validate"(e){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ce(e)};if(!this["~standard"].async)try{const n=this._parseSync({data:e,path:[],parent:r});return Ge(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Ge(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ce(e)},a=this._parse({data:e,path:n.path,parent:n}),o=await(mt(a)?a:Promise.resolve(a));return Hr(n,o)}refine(e,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,o)=>{const l=e(a),u=()=>o.addIssue({code:k.custom,...n(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(f=>f?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(e,r){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(e){return new Me({schema:this,typeName:O.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ee.create(this,this._def)}nullable(){return je.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ge.create(this)}promise(){return kt.create(this,this._def)}or(e){return vt.create([this,e],this._def)}and(e){return _t.create(this,e,this._def)}transform(e){return new Me({...P(this._def),schema:this,typeName:O.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new Et({...P(this._def),innerType:this,defaultValue:r,typeName:O.ZodDefault})}brand(){return new Qn({typeName:O.ZodBranded,type:this,...P(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new Tt({...P(this._def),innerType:this,catchValue:r,typeName:O.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Sr.create(this,e)}readonly(){return It.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const wi=/^c[^\s-]{8,}$/i,xi=/^[0-9a-z]+$/,bi=/^[0-9A-HJKMNP-TV-Z]{26}$/i,ki=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ei=/^[a-z0-9_-]{21}$/i,Ti=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ii=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Ai=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ci="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Jt;const Si=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$i=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ri=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Oi=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Bi=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ni=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Wn="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Pi=new RegExp(`^${Wn}$`);function Yn(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function Mi(t){return new RegExp(`^${Yn(t)}$`)}function ji(t){let e=`${Wn}T${Yn(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function Fi(t,e){return!!((e==="v4"||!e)&&Si.test(t)||(e==="v6"||!e)&&Ri.test(t))}function Ui(t,e){if(!Ti.test(t))return!1;try{const[r]=t.split(".");if(!r)return!1;const n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&a?.typ!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function Li(t,e){return!!((e==="v4"||!e)&&$i.test(t)||(e==="v6"||!e)&&Oi.test(t))}class ke extends j{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==A.string){const o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_type,expected:A.string,received:o.parsedType}),R}const n=new ne;let a;for(const o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(a=this._getOrReturnCtx(e,a),T(a,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(a=this._getOrReturnCtx(e,a),T(a,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){const l=e.data.length>o.value,u=e.data.length<o.value;(l||u)&&(a=this._getOrReturnCtx(e,a),l?T(a,{code:k.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):u&&T(a,{code:k.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")Ai.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"email",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")Jt||(Jt=new RegExp(Ci,"u")),Jt.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"emoji",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")ki.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"uuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")Ei.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"nanoid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")wi.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"cuid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")xi.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"cuid2",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")bi.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"ulid",code:k.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),T(a,{validation:"url",code:k.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"regex",code:k.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(a=this._getOrReturnCtx(e,a),T(a,{code:k.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(a=this._getOrReturnCtx(e,a),T(a,{code:k.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(a=this._getOrReturnCtx(e,a),T(a,{code:k.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?ji(o).test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{code:k.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?Pi.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{code:k.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?Mi(o).test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{code:k.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?Ii.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"duration",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?Fi(e.data,o.version)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"ip",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?Ui(e.data,o.alg)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"jwt",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?Li(e.data,o.version)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"cidr",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?Bi.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"base64",code:k.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?Ni.test(e.data)||(a=this._getOrReturnCtx(e,a),T(a,{validation:"base64url",code:k.invalid_string,message:o.message}),n.dirty()):F.assertNever(o);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(a=>e.test(a),{validation:r,code:k.invalid_string,...C.errToObj(n)})}_addCheck(e){return new ke({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...C.errToObj(e)})}url(e){return this._addCheck({kind:"url",...C.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...C.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...C.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...C.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...C.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...C.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...C.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...C.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...C.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...C.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...C.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...C.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...C.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...C.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...C.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...C.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...C.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...C.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...C.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...C.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...C.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...C.errToObj(r)})}nonempty(e){return this.min(1,C.errToObj(e))}trim(){return new ke({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ke({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ke({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}ke.create=t=>new ke({checks:[],typeName:O.ZodString,coerce:t?.coerce??!1,...P(t)});function Di(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=r>n?r:n,o=Number.parseInt(t.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return o%l/10**a}class ze extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==A.number){const o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_type,expected:A.number,received:o.parsedType}),R}let n;const a=new ne;for(const o of this._def.checks)o.kind==="int"?F.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:k.invalid_type,expected:"integer",received:"float",message:o.message}),a.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="multipleOf"?Di(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),T(n,{code:k.not_finite,message:o.message}),a.dirty()):F.assertNever(o);return{status:a.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,C.toString(r))}gt(e,r){return this.setLimit("min",e,!1,C.toString(r))}lte(e,r){return this.setLimit("max",e,!0,C.toString(r))}lt(e,r){return this.setLimit("max",e,!1,C.toString(r))}setLimit(e,r,n,a){return new ze({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:C.toString(a)}]})}_addCheck(e){return new ze({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:C.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:C.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:C.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:C.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:C.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&F.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}ze.create=t=>new ze({checks:[],typeName:O.ZodNumber,coerce:t?.coerce||!1,...P(t)});class st extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==A.bigint)return this._getInvalidInput(e);let n;const a=new ne;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),T(n,{code:k.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):F.assertNever(o);return{status:a.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return T(r,{code:k.invalid_type,expected:A.bigint,received:r.parsedType}),R}gte(e,r){return this.setLimit("min",e,!0,C.toString(r))}gt(e,r){return this.setLimit("min",e,!1,C.toString(r))}lte(e,r){return this.setLimit("max",e,!0,C.toString(r))}lt(e,r){return this.setLimit("max",e,!1,C.toString(r))}setLimit(e,r,n,a){return new st({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:C.toString(a)}]})}_addCheck(e){return new st({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:C.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}st.create=t=>new st({checks:[],typeName:O.ZodBigInt,coerce:t?.coerce??!1,...P(t)});class er extends j{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==A.boolean){const n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:A.boolean,received:n.parsedType}),R}return ce(e.data)}}er.create=t=>new er({typeName:O.ZodBoolean,coerce:t?.coerce||!1,...P(t)});class gt extends j{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==A.date){const o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_type,expected:A.date,received:o.parsedType}),R}if(Number.isNaN(e.data.getTime())){const o=this._getOrReturnCtx(e);return T(o,{code:k.invalid_date}),R}const n=new ne;let a;for(const o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(a=this._getOrReturnCtx(e,a),T(a,{code:k.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(a=this._getOrReturnCtx(e,a),T(a,{code:k.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):F.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new gt({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:C.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:C.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}gt.create=t=>new gt({checks:[],coerce:t?.coerce||!1,typeName:O.ZodDate,...P(t)});class Jr extends j{_parse(e){if(this._getType(e)!==A.symbol){const n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:A.symbol,received:n.parsedType}),R}return ce(e.data)}}Jr.create=t=>new Jr({typeName:O.ZodSymbol,...P(t)});class tr extends j{_parse(e){if(this._getType(e)!==A.undefined){const n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:A.undefined,received:n.parsedType}),R}return ce(e.data)}}tr.create=t=>new tr({typeName:O.ZodUndefined,...P(t)});class yt extends j{_parse(e){if(this._getType(e)!==A.null){const n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:A.null,received:n.parsedType}),R}return ce(e.data)}}yt.create=t=>new yt({typeName:O.ZodNull,...P(t)});class at extends j{constructor(){super(...arguments),this._any=!0}_parse(e){return ce(e.data)}}at.create=t=>new at({typeName:O.ZodAny,...P(t)});class rr extends j{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ce(e.data)}}rr.create=t=>new rr({typeName:O.ZodUnknown,...P(t)});class Se extends j{_parse(e){const r=this._getOrReturnCtx(e);return T(r,{code:k.invalid_type,expected:A.never,received:r.parsedType}),R}}Se.create=t=>new Se({typeName:O.ZodNever,...P(t)});class Gr extends j{_parse(e){if(this._getType(e)!==A.undefined){const n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:A.void,received:n.parsedType}),R}return ce(e.data)}}Gr.create=t=>new Gr({typeName:O.ZodVoid,...P(t)});class ge extends j{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),a=this._def;if(r.parsedType!==A.array)return T(r,{code:k.invalid_type,expected:A.array,received:r.parsedType}),R;if(a.exactLength!==null){const l=r.data.length>a.exactLength.value,u=r.data.length<a.exactLength.value;(l||u)&&(T(r,{code:l?k.too_big:k.too_small,minimum:u?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(T(r,{code:k.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(T(r,{code:k.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((l,u)=>a.type._parseAsync(new ye(r,l,r.path,u)))).then(l=>ne.mergeArray(n,l));const o=[...r.data].map((l,u)=>a.type._parseSync(new ye(r,l,r.path,u)));return ne.mergeArray(n,o)}get element(){return this._def.type}min(e,r){return new ge({...this._def,minLength:{value:e,message:C.toString(r)}})}max(e,r){return new ge({...this._def,maxLength:{value:e,message:C.toString(r)}})}length(e,r){return new ge({...this._def,exactLength:{value:e,message:C.toString(r)}})}nonempty(e){return this.min(1,e)}}ge.create=(t,e)=>new ge({type:t,minLength:null,maxLength:null,exactLength:null,typeName:O.ZodArray,...P(e)});function qe(t){if(t instanceof z){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Ee.create(qe(n))}return new z({...t._def,shape:()=>e})}else return t instanceof ge?new ge({...t._def,type:qe(t.element)}):t instanceof Ee?Ee.create(qe(t.unwrap())):t instanceof je?je.create(qe(t.unwrap())):t instanceof Ne?Ne.create(t.items.map(e=>qe(e))):t}class z extends j{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=F.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==A.object){const h=this._getOrReturnCtx(e);return T(h,{code:k.invalid_type,expected:A.object,received:h.parsedType}),R}const{status:n,ctx:a}=this._processInputParams(e),{shape:o,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof Se&&this._def.unknownKeys==="strip"))for(const h in a.data)l.includes(h)||u.push(h);const f=[];for(const h of l){const d=o[h],v=a.data[h];f.push({key:{status:"valid",value:h},value:d._parse(new ye(a,v,a.path,h)),alwaysSet:h in a.data})}if(this._def.catchall instanceof Se){const h=this._def.unknownKeys;if(h==="passthrough")for(const d of u)f.push({key:{status:"valid",value:d},value:{status:"valid",value:a.data[d]}});else if(h==="strict")u.length>0&&(T(a,{code:k.unrecognized_keys,keys:u}),n.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const d of u){const v=a.data[d];f.push({key:{status:"valid",value:d},value:h._parse(new ye(a,v,a.path,d)),alwaysSet:d in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const h=[];for(const d of f){const v=await d.key,g=await d.value;h.push({key:v,value:g,alwaysSet:d.alwaysSet})}return h}).then(h=>ne.mergeObjectSync(n,h)):ne.mergeObjectSync(n,f)}get shape(){return this._def.shape()}strict(e){return C.errToObj,new z({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{const a=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:C.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new z({...this._def,unknownKeys:"strip"})}passthrough(){return new z({...this._def,unknownKeys:"passthrough"})}extend(e){return new z({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new z({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:O.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new z({...this._def,catchall:e})}pick(e){const r={};for(const n of F.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new z({...this._def,shape:()=>r})}omit(e){const r={};for(const n of F.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new z({...this._def,shape:()=>r})}deepPartial(){return qe(this)}partial(e){const r={};for(const n of F.objectKeys(this.shape)){const a=this.shape[n];e&&!e[n]?r[n]=a:r[n]=a.optional()}return new z({...this._def,shape:()=>r})}required(e){const r={};for(const n of F.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof Ee;)o=o._def.innerType;r[n]=o}return new z({...this._def,shape:()=>r})}keyof(){return Xn(F.objectKeys(this.shape))}}z.create=(t,e)=>new z({shape:()=>t,unknownKeys:"strip",catchall:Se.create(),typeName:O.ZodObject,...P(e)});z.strictCreate=(t,e)=>new z({shape:()=>t,unknownKeys:"strict",catchall:Se.create(),typeName:O.ZodObject,...P(e)});z.lazycreate=(t,e)=>new z({shape:t,unknownKeys:"strip",catchall:Se.create(),typeName:O.ZodObject,...P(e)});class vt extends j{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function a(o){for(const u of o)if(u.result.status==="valid")return u.result;for(const u of o)if(u.result.status==="dirty")return r.common.issues.push(...u.ctx.common.issues),u.result;const l=o.map(u=>new Te(u.ctx.common.issues));return T(r,{code:k.invalid_union,unionErrors:l}),R}if(r.common.async)return Promise.all(n.map(async o=>{const l={...r,common:{...r.common,issues:[]},parent:null};return{result:await o._parseAsync({data:r.data,path:r.path,parent:l}),ctx:l}})).then(a);{let o;const l=[];for(const f of n){const h={...r,common:{...r.common,issues:[]},parent:null},d=f._parseSync({data:r.data,path:r.path,parent:h});if(d.status==="valid")return d;d.status==="dirty"&&!o&&(o={result:d,ctx:h}),h.common.issues.length&&l.push(h.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;const u=l.map(f=>new Te(f));return T(r,{code:k.invalid_union,unionErrors:u}),R}}get options(){return this._def.options}}vt.create=(t,e)=>new vt({options:t,typeName:O.ZodUnion,...P(e)});const _e=t=>t instanceof xt?_e(t.schema):t instanceof Me?_e(t.innerType()):t instanceof bt?[t.value]:t instanceof Pe?t.options:t instanceof sr?F.objectValues(t.enum):t instanceof Et?_e(t._def.innerType):t instanceof tr?[void 0]:t instanceof yt?[null]:t instanceof Ee?[void 0,..._e(t.unwrap())]:t instanceof je?[null,..._e(t.unwrap())]:t instanceof Qn||t instanceof It?_e(t.unwrap()):t instanceof Tt?_e(t._def.innerType):[];class Cr extends j{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==A.object)return T(r,{code:k.invalid_type,expected:A.object,received:r.parsedType}),R;const n=this.discriminator,a=r.data[n],o=this.optionsMap.get(a);return o?r.common.async?o._parseAsync({data:r.data,path:r.path,parent:r}):o._parseSync({data:r.data,path:r.path,parent:r}):(T(r,{code:k.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),R)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const a=new Map;for(const o of r){const l=_e(o.shape[e]);if(!l.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const u of l){if(a.has(u))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(u)}`);a.set(u,o)}}return new Cr({typeName:O.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:a,...P(n)})}}function nr(t,e){const r=Ce(t),n=Ce(e);if(t===e)return{valid:!0,data:t};if(r===A.object&&n===A.object){const a=F.objectKeys(e),o=F.objectKeys(t).filter(u=>a.indexOf(u)!==-1),l={...t,...e};for(const u of o){const f=nr(t[u],e[u]);if(!f.valid)return{valid:!1};l[u]=f.data}return{valid:!0,data:l}}else if(r===A.array&&n===A.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let o=0;o<t.length;o++){const l=t[o],u=e[o],f=nr(l,u);if(!f.valid)return{valid:!1};a.push(f.data)}return{valid:!0,data:a}}else return r===A.date&&n===A.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class _t extends j{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),a=(o,l)=>{if(Zr(o)||Zr(l))return R;const u=nr(o.value,l.value);return u.valid?((qr(o)||qr(l))&&r.dirty(),{status:r.value,value:u.data}):(T(n,{code:k.invalid_intersection_types}),R)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,l])=>a(o,l)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}_t.create=(t,e,r)=>new _t({left:t,right:e,typeName:O.ZodIntersection,...P(r)});class Ne extends j{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==A.array)return T(n,{code:k.invalid_type,expected:A.array,received:n.parsedType}),R;if(n.data.length<this._def.items.length)return T(n,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),R;!this._def.rest&&n.data.length>this._def.items.length&&(T(n,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const o=[...n.data].map((l,u)=>{const f=this._def.items[u]||this._def.rest;return f?f._parse(new ye(n,l,n.path,u)):null}).filter(l=>!!l);return n.common.async?Promise.all(o).then(l=>ne.mergeArray(r,l)):ne.mergeArray(r,o)}get items(){return this._def.items}rest(e){return new Ne({...this._def,rest:e})}}Ne.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ne({items:t,typeName:O.ZodTuple,rest:null,...P(e)})};class wt extends j{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==A.object)return T(n,{code:k.invalid_type,expected:A.object,received:n.parsedType}),R;const a=[],o=this._def.keyType,l=this._def.valueType;for(const u in n.data)a.push({key:o._parse(new ye(n,u,n.path,u)),value:l._parse(new ye(n,n.data[u],n.path,u)),alwaysSet:u in n.data});return n.common.async?ne.mergeObjectAsync(r,a):ne.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof j?new wt({keyType:e,valueType:r,typeName:O.ZodRecord,...P(n)}):new wt({keyType:ke.create(),valueType:e,typeName:O.ZodRecord,...P(r)})}}class zr extends j{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==A.map)return T(n,{code:k.invalid_type,expected:A.map,received:n.parsedType}),R;const a=this._def.keyType,o=this._def.valueType,l=[...n.data.entries()].map(([u,f],h)=>({key:a._parse(new ye(n,u,n.path,[h,"key"])),value:o._parse(new ye(n,f,n.path,[h,"value"]))}));if(n.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const f of l){const h=await f.key,d=await f.value;if(h.status==="aborted"||d.status==="aborted")return R;(h.status==="dirty"||d.status==="dirty")&&r.dirty(),u.set(h.value,d.value)}return{status:r.value,value:u}})}else{const u=new Map;for(const f of l){const h=f.key,d=f.value;if(h.status==="aborted"||d.status==="aborted")return R;(h.status==="dirty"||d.status==="dirty")&&r.dirty(),u.set(h.value,d.value)}return{status:r.value,value:u}}}}zr.create=(t,e,r)=>new zr({valueType:e,keyType:t,typeName:O.ZodMap,...P(r)});class it extends j{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==A.set)return T(n,{code:k.invalid_type,expected:A.set,received:n.parsedType}),R;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(T(n,{code:k.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(T(n,{code:k.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const o=this._def.valueType;function l(f){const h=new Set;for(const d of f){if(d.status==="aborted")return R;d.status==="dirty"&&r.dirty(),h.add(d.value)}return{status:r.value,value:h}}const u=[...n.data.values()].map((f,h)=>o._parse(new ye(n,f,n.path,h)));return n.common.async?Promise.all(u).then(f=>l(f)):l(u)}min(e,r){return new it({...this._def,minSize:{value:e,message:C.toString(r)}})}max(e,r){return new it({...this._def,maxSize:{value:e,message:C.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}it.create=(t,e)=>new it({valueType:t,minSize:null,maxSize:null,typeName:O.ZodSet,...P(e)});class xt extends j{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}xt.create=(t,e)=>new xt({getter:t,typeName:O.ZodLazy,...P(e)});class bt extends j{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return T(r,{received:r.data,code:k.invalid_literal,expected:this._def.value}),R}return{status:"valid",value:e.data}}get value(){return this._def.value}}bt.create=(t,e)=>new bt({value:t,typeName:O.ZodLiteral,...P(e)});function Xn(t,e){return new Pe({values:t,typeName:O.ZodEnum,...P(e)})}class Pe extends j{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return T(r,{expected:F.joinValues(n),received:r.parsedType,code:k.invalid_type}),R}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return T(r,{received:r.data,code:k.invalid_enum_value,options:n}),R}return ce(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return Pe.create(e,{...this._def,...r})}exclude(e,r=this._def){return Pe.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}Pe.create=Xn;class sr extends j{_parse(e){const r=F.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==A.string&&n.parsedType!==A.number){const a=F.objectValues(r);return T(n,{expected:F.joinValues(a),received:n.parsedType,code:k.invalid_type}),R}if(this._cache||(this._cache=new Set(F.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=F.objectValues(r);return T(n,{received:n.data,code:k.invalid_enum_value,options:a}),R}return ce(e.data)}get enum(){return this._def.values}}sr.create=(t,e)=>new sr({values:t,typeName:O.ZodNativeEnum,...P(e)});class kt extends j{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==A.promise&&r.common.async===!1)return T(r,{code:k.invalid_type,expected:A.promise,received:r.parsedType}),R;const n=r.parsedType===A.promise?r.data:Promise.resolve(r.data);return ce(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}kt.create=(t,e)=>new kt({type:t,typeName:O.ZodPromise,...P(e)});class Me extends j{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===O.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),a=this._def.effect||null,o={addIssue:l=>{T(n,l),l.fatal?r.abort():r.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),a.type==="preprocess"){const l=a.transform(n.data,o);if(n.common.async)return Promise.resolve(l).then(async u=>{if(r.value==="aborted")return R;const f=await this._def.schema._parseAsync({data:u,path:n.path,parent:n});return f.status==="aborted"?R:f.status==="dirty"||r.value==="dirty"?tt(f.value):f});{if(r.value==="aborted")return R;const u=this._def.schema._parseSync({data:l,path:n.path,parent:n});return u.status==="aborted"?R:u.status==="dirty"||r.value==="dirty"?tt(u.value):u}}if(a.type==="refinement"){const l=u=>{const f=a.refinement(u,o);if(n.common.async)return Promise.resolve(f);if(f instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(n.common.async===!1){const u=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return u.status==="aborted"?R:(u.status==="dirty"&&r.dirty(),l(u.value),{status:r.value,value:u.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(u=>u.status==="aborted"?R:(u.status==="dirty"&&r.dirty(),l(u.value).then(()=>({status:r.value,value:u.value}))))}if(a.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ge(l))return R;const u=a.transform(l.value,o);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:u}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>Ge(l)?Promise.resolve(a.transform(l.value,o)).then(u=>({status:r.value,value:u})):R);F.assertNever(a)}}Me.create=(t,e,r)=>new Me({schema:t,typeName:O.ZodEffects,effect:e,...P(r)});Me.createWithPreprocess=(t,e,r)=>new Me({schema:e,effect:{type:"preprocess",transform:t},typeName:O.ZodEffects,...P(r)});class Ee extends j{_parse(e){return this._getType(e)===A.undefined?ce(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ee.create=(t,e)=>new Ee({innerType:t,typeName:O.ZodOptional,...P(e)});class je extends j{_parse(e){return this._getType(e)===A.null?ce(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}je.create=(t,e)=>new je({innerType:t,typeName:O.ZodNullable,...P(e)});class Et extends j{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===A.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Et.create=(t,e)=>new Et({innerType:t,typeName:O.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...P(e)});class Tt extends j{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return mt(a)?a.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Te(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Te(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Tt.create=(t,e)=>new Tt({innerType:t,typeName:O.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...P(e)});class Wr extends j{_parse(e){if(this._getType(e)!==A.nan){const n=this._getOrReturnCtx(e);return T(n,{code:k.invalid_type,expected:A.nan,received:n.parsedType}),R}return{status:"valid",value:e.data}}}Wr.create=t=>new Wr({typeName:O.ZodNaN,...P(t)});class Qn extends j{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Sr extends j{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?R:o.status==="dirty"?(r.dirty(),tt(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?R:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(e,r){return new Sr({in:e,out:r,typeName:O.ZodPipeline})}}class It extends j{_parse(e){const r=this._def.innerType._parse(e),n=a=>(Ge(a)&&(a.value=Object.freeze(a.value)),a);return mt(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}It.create=(t,e)=>new It({innerType:t,typeName:O.ZodReadonly,...P(e)});function Yr(t,e){const r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function Vi(t,e={},r){return t?at.create().superRefine((n,a)=>{const o=t(n);if(o instanceof Promise)return o.then(l=>{if(!l){const u=Yr(e,n),f=u.fatal??r??!0;a.addIssue({code:"custom",...u,fatal:f})}});if(!o){const l=Yr(e,n),u=l.fatal??r??!0;a.addIssue({code:"custom",...l,fatal:u})}}):at.create()}var O;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(O||(O={}));const ql=(t,e={message:`Input not instance of ${t.name}`})=>Vi(r=>r instanceof t,e),S=ke.create,N=ze.create,Hl=er.create,Jl=yt.create,Ki=at.create,es=rr.create;Se.create;const Z=ge.create,I=z.create,Mt=vt.create,pt=Cr.create;_t.create;Ne.create;const ts=wt.create,Gl=xt.create,Y=bt.create,Zi=Pe.create;kt.create;const zl=Ee.create;je.create;function qi({prompt:t,useLegacyFunctionCalling:e=!1,systemMessageMode:r="system"}){const n=[];for(const{role:a,content:o}of t)switch(a){case"system":{switch(r){case"system":{n.push({role:"system",content:o});break}case"developer":{n.push({role:"developer",content:o});break}case"remove":break;default:{const l=r;throw new Error(`Unsupported system message mode: ${l}`)}}break}case"user":{if(o.length===1&&o[0].type==="text"){n.push({role:"user",content:o[0].text});break}n.push({role:"user",content:o.map(l=>{var u,f,h;switch(l.type){case"text":return{type:"text",text:l.text};case"image":return{type:"image_url",image_url:{url:l.image instanceof URL?l.image.toString():`data:${(u=l.mimeType)!=null?u:"image/jpeg"};base64,${mi(l.image)}`,detail:(h=(f=l.providerMetadata)==null?void 0:f.openai)==null?void 0:h.imageDetail}};case"file":{if(l.data instanceof URL)throw new ae({functionality:"'File content parts with URL data' functionality not supported."});switch(l.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:l.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:l.data,format:"mp3"}};default:throw new ae({functionality:`File content part type ${l.mimeType} in user messages`})}}}})});break}case"assistant":{let l="";const u=[];for(const f of o)switch(f.type){case"text":{l+=f.text;break}case"tool-call":{u.push({id:f.toolCallId,type:"function",function:{name:f.toolName,arguments:JSON.stringify(f.args)}});break}default:{const h=f;throw new Error(`Unsupported part: ${h}`)}}if(e){if(u.length>1)throw new ae({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});n.push({role:"assistant",content:l,function_call:u.length>0?u[0].function:void 0})}else n.push({role:"assistant",content:l,tool_calls:u.length>0?u:void 0});break}case"tool":{for(const l of o)e?n.push({role:"function",name:l.toolName,content:JSON.stringify(l.result)}):n.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result)});break}default:{const l=a;throw new Error(`Unsupported role: ${l}`)}}return n}function Xr(t){var e,r;return(r=(e=t?.content)==null?void 0:e.map(({token:n,logprob:a,top_logprobs:o})=>({token:n,logprob:a,topLogprobs:o?o.map(({token:l,logprob:u})=>({token:l,logprob:u})):[]})))!=null?r:void 0}function At(t){switch(t){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var $r=I({error:I({message:S(),type:S().nullish(),param:Ki().nullish(),code:Mt([S(),N()]).nullish()})}),We=hi({errorSchema:$r,errorToMessage:t=>t.error.message});function Ct({id:t,model:e,created:r}){return{id:t??void 0,modelId:e??void 0,timestamp:r!=null?new Date(r*1e3):void 0}}function Hi({mode:t,useLegacyFunctionCalling:e=!1,structuredOutputs:r}){var n;const a=(n=t.tools)!=null&&n.length?t.tools:void 0,o=[];if(a==null)return{tools:void 0,tool_choice:void 0,toolWarnings:o};const l=t.toolChoice;if(e){const h=[];for(const v of a)v.type==="provider-defined"?o.push({type:"unsupported-tool",tool:v}):h.push({name:v.name,description:v.description,parameters:v.parameters});if(l==null)return{functions:h,function_call:void 0,toolWarnings:o};switch(l.type){case"auto":case"none":case void 0:return{functions:h,function_call:void 0,toolWarnings:o};case"required":throw new ae({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:h,function_call:{name:l.toolName},toolWarnings:o}}}const u=[];for(const h of a)h.type==="provider-defined"?o.push({type:"unsupported-tool",tool:h}):u.push({type:"function",function:{name:h.name,description:h.description,parameters:h.parameters,strict:r?!0:void 0}});if(l==null)return{tools:u,tool_choice:void 0,toolWarnings:o};const f=l.type;switch(f){case"auto":case"none":case"required":return{tools:u,tool_choice:f,toolWarnings:o};case"tool":return{tools:u,tool_choice:{type:"function",function:{name:l.toolName}},toolWarnings:o};default:{const h=f;throw new ae({functionality:`Unsupported tool choice type: ${h}`})}}}var Ji=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get supportsStructuredOutputs(){var t;return(t=this.settings.structuredOutputs)!=null?t:St(this.modelId)}get defaultObjectGenerationMode(){return Wi(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:a,topK:o,frequencyPenalty:l,presencePenalty:u,stopSequences:f,responseFormat:h,seed:d,providerMetadata:v}){var g,w,E,x,b,$,B,D;const H=t.type,U=[];o!=null&&U.push({type:"unsupported-setting",setting:"topK"}),h?.type==="json"&&h.schema!=null&&!this.supportsStructuredOutputs&&U.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const ue=this.settings.useLegacyFunctionCalling;if(ue&&this.settings.parallelToolCalls===!0)throw new ae({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(ue&&this.supportsStructuredOutputs)throw new ae({functionality:"structuredOutputs with useLegacyFunctionCalling"});Qr(this.modelId)==="remove"&&e.some(re=>re.role==="system")&&U.push({type:"other",message:"system messages are removed for this model"});const L={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:a,frequency_penalty:l,presence_penalty:u,response_format:h?.type==="json"?this.supportsStructuredOutputs&&h.schema!=null?{type:"json_schema",json_schema:{schema:h.schema,strict:!0,name:(g=h.name)!=null?g:"response",description:h.description}}:{type:"json_object"}:void 0,stop:f,seed:d,max_completion_tokens:(w=v?.openai)==null?void 0:w.maxCompletionTokens,store:(E=v?.openai)==null?void 0:E.store,metadata:(x=v?.openai)==null?void 0:x.metadata,prediction:(b=v?.openai)==null?void 0:b.prediction,reasoning_effort:(B=($=v?.openai)==null?void 0:$.reasoningEffort)!=null?B:this.settings.reasoningEffort,messages:qi({prompt:e,useLegacyFunctionCalling:ue,systemMessageMode:Qr(this.modelId)})};switch(St(this.modelId)&&(L.temperature!=null&&(L.temperature=void 0,U.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),L.top_p!=null&&(L.top_p=void 0,U.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),L.frequency_penalty!=null&&(L.frequency_penalty=void 0,U.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),L.presence_penalty!=null&&(L.presence_penalty=void 0,U.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),L.logit_bias!=null&&(L.logit_bias=void 0,U.push({type:"other",message:"logitBias is not supported for reasoning models"})),L.logprobs!=null&&(L.logprobs=void 0,U.push({type:"other",message:"logprobs is not supported for reasoning models"})),L.top_logprobs!=null&&(L.top_logprobs=void 0,U.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),L.max_tokens!=null&&(L.max_completion_tokens==null&&(L.max_completion_tokens=L.max_tokens),L.max_tokens=void 0)),H){case"regular":{const{tools:re,tool_choice:$e,functions:Re,function_call:Ue,toolWarnings:Le}=Hi({mode:t,useLegacyFunctionCalling:ue,structuredOutputs:this.supportsStructuredOutputs});return{args:{...L,tools:re,tool_choice:$e,functions:Re,function_call:Ue},warnings:[...U,...Le]}}case"object-json":return{args:{...L,response_format:this.supportsStructuredOutputs&&t.schema!=null?{type:"json_schema",json_schema:{schema:t.schema,strict:!0,name:(D=t.name)!=null?D:"response",description:t.description}}:{type:"json_object"}},warnings:U};case"object-tool":return{args:ue?{...L,function_call:{name:t.tool.name},functions:[{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters}]}:{...L,tool_choice:{type:"function",function:{name:t.tool.name}},tools:[{type:"function",function:{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:U};default:{const re=H;throw new Error(`Unsupported type: ${re}`)}}}async doGenerate(t){var e,r,n,a,o,l,u,f;const{args:h,warnings:d}=this.getArgs(t),{responseHeaders:v,value:g}=await Je({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:He(this.config.headers(),t.headers),body:h,failedResponseHandler:We,successfulResponseHandler:Pt(Gi),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:w,...E}=h,x=g.choices[0],b=(e=g.usage)==null?void 0:e.completion_tokens_details,$=(r=g.usage)==null?void 0:r.prompt_tokens_details,B={openai:{}};return b?.reasoning_tokens!=null&&(B.openai.reasoningTokens=b?.reasoning_tokens),b?.accepted_prediction_tokens!=null&&(B.openai.acceptedPredictionTokens=b?.accepted_prediction_tokens),b?.rejected_prediction_tokens!=null&&(B.openai.rejectedPredictionTokens=b?.rejected_prediction_tokens),$?.cached_tokens!=null&&(B.openai.cachedPromptTokens=$?.cached_tokens),{text:(n=x.message.content)!=null?n:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&x.message.function_call?[{toolCallType:"function",toolCallId:et(),toolName:x.message.function_call.name,args:x.message.function_call.arguments}]:(a=x.message.tool_calls)==null?void 0:a.map(D=>{var H;return{toolCallType:"function",toolCallId:(H=D.id)!=null?H:et(),toolName:D.function.name,args:D.function.arguments}}),finishReason:At(x.finish_reason),usage:{promptTokens:(l=(o=g.usage)==null?void 0:o.prompt_tokens)!=null?l:NaN,completionTokens:(f=(u=g.usage)==null?void 0:u.completion_tokens)!=null?f:NaN},rawCall:{rawPrompt:w,rawSettings:E},rawResponse:{headers:v},request:{body:JSON.stringify(h)},response:Ct(g),warnings:d,logprobs:Xr(x.logprobs),providerMetadata:B}}async doStream(t){var e;if((e=this.settings.simulateStreaming)!=null?e:Yi(this.modelId)){const b=await this.doGenerate(t);return{stream:new ReadableStream({start(B){if(B.enqueue({type:"response-metadata",...b.response}),b.text&&B.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const D of b.toolCalls)B.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:D.toolCallId,toolName:D.toolName,argsTextDelta:D.args}),B.enqueue({type:"tool-call",...D});B.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),B.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:r,warnings:n}=this.getArgs(t),a={...r,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:o,value:l}=await Je({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:He(this.config.headers(),t.headers),body:a,failedResponseHandler:We,successfulResponseHandler:zn(zi),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:u,...f}=r,h=[];let d="unknown",v={promptTokens:void 0,completionTokens:void 0},g,w=!0;const{useLegacyFunctionCalling:E}=this.settings,x={openai:{}};return{stream:l.pipeThrough(new TransformStream({transform(b,$){var B,D,H,U,ue,L,re,$e,Re,Ue,Le,ot;if(!b.success){d="error",$.enqueue({type:"error",error:b.error});return}const Ie=b.value;if("error"in Ie){d="error",$.enqueue({type:"error",error:Ie.error});return}if(w&&(w=!1,$.enqueue({type:"response-metadata",...Ct(Ie)})),Ie.usage!=null){const{prompt_tokens:Q,completion_tokens:ve,prompt_tokens_details:ee,completion_tokens_details:K}=Ie.usage;v={promptTokens:Q??void 0,completionTokens:ve??void 0},K?.reasoning_tokens!=null&&(x.openai.reasoningTokens=K?.reasoning_tokens),K?.accepted_prediction_tokens!=null&&(x.openai.acceptedPredictionTokens=K?.accepted_prediction_tokens),K?.rejected_prediction_tokens!=null&&(x.openai.rejectedPredictionTokens=K?.rejected_prediction_tokens),ee?.cached_tokens!=null&&(x.openai.cachedPromptTokens=ee?.cached_tokens)}const de=Ie.choices[0];if(de?.finish_reason!=null&&(d=At(de.finish_reason)),de?.delta==null)return;const Oe=de.delta;Oe.content!=null&&$.enqueue({type:"text-delta",textDelta:Oe.content});const De=Xr(de?.logprobs);De?.length&&(g===void 0&&(g=[]),g.push(...De));const Xe=E&&Oe.function_call!=null?[{type:"function",id:et(),function:Oe.function_call,index:0}]:Oe.tool_calls;if(Xe!=null)for(const Q of Xe){const ve=Q.index;if(h[ve]==null){if(Q.type!=="function")throw new Zt({data:Q,message:"Expected 'function' type."});if(Q.id==null)throw new Zt({data:Q,message:"Expected 'id' to be a string."});if(((B=Q.function)==null?void 0:B.name)==null)throw new Zt({data:Q,message:"Expected 'function.name' to be a string."});h[ve]={id:Q.id,type:"function",function:{name:Q.function.name,arguments:(D=Q.function.arguments)!=null?D:""},hasFinished:!1};const K=h[ve];((H=K.function)==null?void 0:H.name)!=null&&((U=K.function)==null?void 0:U.arguments)!=null&&(K.function.arguments.length>0&&$.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:K.id,toolName:K.function.name,argsTextDelta:K.function.arguments}),Vr(K.function.arguments)&&($.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(ue=K.id)!=null?ue:et(),toolName:K.function.name,args:K.function.arguments}),K.hasFinished=!0));continue}const ee=h[ve];ee.hasFinished||(((L=Q.function)==null?void 0:L.arguments)!=null&&(ee.function.arguments+=($e=(re=Q.function)==null?void 0:re.arguments)!=null?$e:""),$.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:(Re=Q.function.arguments)!=null?Re:""}),((Ue=ee.function)==null?void 0:Ue.name)!=null&&((Le=ee.function)==null?void 0:Le.arguments)!=null&&Vr(ee.function.arguments)&&($.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(ot=ee.id)!=null?ot:et(),toolName:ee.function.name,args:ee.function.arguments}),ee.hasFinished=!0))}},flush(b){var $,B;b.enqueue({type:"finish",finishReason:d,logprobs:g,usage:{promptTokens:($=v.promptTokens)!=null?$:NaN,completionTokens:(B=v.completionTokens)!=null?B:NaN},...x!=null?{providerMetadata:x}:{}})}})),rawCall:{rawPrompt:u,rawSettings:f},rawResponse:{headers:o},request:{body:JSON.stringify(a)},warnings:n}}},rs=I({prompt_tokens:N().nullish(),completion_tokens:N().nullish(),prompt_tokens_details:I({cached_tokens:N().nullish()}).nullish(),completion_tokens_details:I({reasoning_tokens:N().nullish(),accepted_prediction_tokens:N().nullish(),rejected_prediction_tokens:N().nullish()}).nullish()}).nullish(),Gi=I({id:S().nullish(),created:N().nullish(),model:S().nullish(),choices:Z(I({message:I({role:Y("assistant").nullish(),content:S().nullish(),function_call:I({arguments:S(),name:S()}).nullish(),tool_calls:Z(I({id:S().nullish(),type:Y("function"),function:I({name:S(),arguments:S()})})).nullish()}),index:N(),logprobs:I({content:Z(I({token:S(),logprob:N(),top_logprobs:Z(I({token:S(),logprob:N()}))})).nullable()}).nullish(),finish_reason:S().nullish()})),usage:rs}),zi=Mt([I({id:S().nullish(),created:N().nullish(),model:S().nullish(),choices:Z(I({delta:I({role:Zi(["assistant"]).nullish(),content:S().nullish(),function_call:I({name:S().optional(),arguments:S().optional()}).nullish(),tool_calls:Z(I({index:N(),id:S().nullish(),type:Y("function").optional(),function:I({name:S().nullish(),arguments:S().nullish()})})).nullish()}).nullish(),logprobs:I({content:Z(I({token:S(),logprob:N(),top_logprobs:Z(I({token:S(),logprob:N()}))})).nullable()}).nullish(),finish_reason:S().nullable().optional(),index:N()})),usage:rs}),$r]);function St(t){return t==="o1"||t.startsWith("o1-")||t==="o3"||t.startsWith("o3-")}function Wi(t){return t.startsWith("gpt-4o-audio-preview")}function Qr(t){var e,r;return St(t)?(r=(e=ns[t])==null?void 0:e.systemMessageMode)!=null?r:"developer":"system"}function Yi(t){var e,r;return St(t)?(r=(e=ns[t])==null?void 0:e.simulateStreamingByDefault)!=null?r:!0:!1}var ns={"o1-mini":{systemMessageMode:"remove",simulateStreamingByDefault:!1},"o1-mini-2024-09-12":{systemMessageMode:"remove",simulateStreamingByDefault:!1},"o1-preview":{systemMessageMode:"remove",simulateStreamingByDefault:!1},"o1-preview-2024-09-12":{systemMessageMode:"remove",simulateStreamingByDefault:!1}};function Xi({prompt:t,inputFormat:e,user:r="user",assistant:n="assistant"}){if(e==="prompt"&&t.length===1&&t[0].role==="user"&&t[0].content.length===1&&t[0].content[0].type==="text")return{prompt:t[0].content[0].text};let a="";t[0].role==="system"&&(a+=`${t[0].content}

`,t=t.slice(1));for(const{role:o,content:l}of t)switch(o){case"system":throw new Ua({message:"Unexpected system message in prompt: ${content}",prompt:t});case"user":{const u=l.map(f=>{switch(f.type){case"text":return f.text;case"image":throw new ae({functionality:"images"})}}).join("");a+=`${r}:
${u}

`;break}case"assistant":{const u=l.map(f=>{switch(f.type){case"text":return f.text;case"tool-call":throw new ae({functionality:"tool-call messages"})}}).join("");a+=`${n}:
${u}

`;break}case"tool":throw new ae({functionality:"tool messages"});default:{const u=o;throw new Error(`Unsupported role: ${u}`)}}return a+=`${n}:
`,{prompt:a,stopSequences:[`
${r}:`]}}function en(t){return t?.tokens.map((e,r)=>({token:e,logprob:t.token_logprobs[r],topLogprobs:t.top_logprobs?Object.entries(t.top_logprobs[r]).map(([n,a])=>({token:n,logprob:a})):[]}))}var Qi=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,inputFormat:e,prompt:r,maxTokens:n,temperature:a,topP:o,topK:l,frequencyPenalty:u,presencePenalty:f,stopSequences:h,responseFormat:d,seed:v}){var g;const w=t.type,E=[];l!=null&&E.push({type:"unsupported-setting",setting:"topK"}),d!=null&&d.type!=="text"&&E.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:x,stopSequences:b}=Xi({prompt:r,inputFormat:e}),$=[...b??[],...h??[]],B={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:a,top_p:o,frequency_penalty:u,presence_penalty:f,seed:v,prompt:x,stop:$.length>0?$:void 0};switch(w){case"regular":{if((g=t.tools)!=null&&g.length)throw new ae({functionality:"tools"});if(t.toolChoice)throw new ae({functionality:"toolChoice"});return{args:B,warnings:E}}case"object-json":throw new ae({functionality:"object-json mode"});case"object-tool":throw new ae({functionality:"object-tool mode"});default:{const D=w;throw new Error(`Unsupported type: ${D}`)}}}async doGenerate(t){const{args:e,warnings:r}=this.getArgs(t),{responseHeaders:n,value:a}=await Je({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:He(this.config.headers(),t.headers),body:e,failedResponseHandler:We,successfulResponseHandler:Pt(eo),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:o,...l}=e,u=a.choices[0];return{text:u.text,usage:{promptTokens:a.usage.prompt_tokens,completionTokens:a.usage.completion_tokens},finishReason:At(u.finish_reason),logprobs:en(u.logprobs),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:n},response:Ct(a),warnings:r,request:{body:JSON.stringify(e)}}}async doStream(t){const{args:e,warnings:r}=this.getArgs(t),n={...e,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:a,value:o}=await Je({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:He(this.config.headers(),t.headers),body:n,failedResponseHandler:We,successfulResponseHandler:zn(to),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:l,...u}=e;let f="unknown",h={promptTokens:Number.NaN,completionTokens:Number.NaN},d,v=!0;return{stream:o.pipeThrough(new TransformStream({transform(g,w){if(!g.success){f="error",w.enqueue({type:"error",error:g.error});return}const E=g.value;if("error"in E){f="error",w.enqueue({type:"error",error:E.error});return}v&&(v=!1,w.enqueue({type:"response-metadata",...Ct(E)})),E.usage!=null&&(h={promptTokens:E.usage.prompt_tokens,completionTokens:E.usage.completion_tokens});const x=E.choices[0];x?.finish_reason!=null&&(f=At(x.finish_reason)),x?.text!=null&&w.enqueue({type:"text-delta",textDelta:x.text});const b=en(x?.logprobs);b?.length&&(d===void 0&&(d=[]),d.push(...b))},flush(g){g.enqueue({type:"finish",finishReason:f,logprobs:d,usage:h})}})),rawCall:{rawPrompt:l,rawSettings:u},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(n)}}}},eo=I({id:S().nullish(),created:N().nullish(),model:S().nullish(),choices:Z(I({text:S(),finish_reason:S(),logprobs:I({tokens:Z(S()),token_logprobs:Z(N()),top_logprobs:Z(ts(S(),N())).nullable()}).nullish()})),usage:I({prompt_tokens:N(),completion_tokens:N()})}),to=Mt([I({id:S().nullish(),created:N().nullish(),model:S().nullish(),choices:Z(I({text:S(),finish_reason:S().nullish(),index:N(),logprobs:I({tokens:Z(S()),token_logprobs:Z(N()),top_logprobs:Z(ts(S(),N())).nullable()}).nullish()})),usage:I({prompt_tokens:N(),completion_tokens:N()}).nullish()}),$r]),ro=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:2048}get supportsParallelCalls(){var t;return(t=this.settings.supportsParallelCalls)!=null?t:!0}async doEmbed({values:t,headers:e,abortSignal:r}){if(t.length>this.maxEmbeddingsPerCall)throw new Za({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:a}=await Je({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:He(this.config.headers(),e),body:{model:this.modelId,input:t,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:We,successfulResponseHandler:Pt(no),abortSignal:r,fetch:this.config.fetch});return{embeddings:a.data.map(o=>o.embedding),usage:a.usage?{tokens:a.usage.prompt_tokens}:void 0,rawResponse:{headers:n}}}},no=I({data:Z(I({embedding:Z(N())})),usage:I({prompt_tokens:N()}).nullish()}),so={"dall-e-3":1,"dall-e-2":10},ao=class{constructor(t,e,r){this.modelId=t,this.settings=e,this.config=r,this.specificationVersion="v1"}get maxImagesPerCall(){var t,e;return(e=(t=this.settings.maxImagesPerCall)!=null?t:so[this.modelId])!=null?e:1}get provider(){return this.config.provider}async doGenerate({prompt:t,n:e,size:r,aspectRatio:n,seed:a,providerOptions:o,headers:l,abortSignal:u}){var f,h,d,v;const g=[];n!=null&&g.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),a!=null&&g.push({type:"unsupported-setting",setting:"seed"});const w=(d=(h=(f=this.config._internal)==null?void 0:f.currentDate)==null?void 0:h.call(f))!=null?d:new Date,{value:E,responseHeaders:x}=await Je({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:He(this.config.headers(),l),body:{model:this.modelId,prompt:t,n:e,size:r,...(v=o.openai)!=null?v:{},response_format:"b64_json"},failedResponseHandler:We,successfulResponseHandler:Pt(io),abortSignal:u,fetch:this.config.fetch});return{images:E.data.map(b=>b.b64_json),warnings:g,response:{timestamp:w,modelId:this.modelId,headers:x}}}},io=I({data:Z(I({b64_json:S()}))});function ss(t={}){var e,r,n;const a=(e=gi(t.baseURL))!=null?e:"https://api.openai.com/v1",o=(r=t.compatibility)!=null?r:"compatible",l=(n=t.name)!=null?n:"openai",u=()=>({Authorization:`Bearer ${ni({apiKey:t.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":t.organization,"OpenAI-Project":t.project,...t.headers}),f=(E,x={})=>new Ji(E,x,{provider:`${l}.chat`,url:({path:b})=>`${a}${b}`,headers:u,compatibility:o,fetch:t.fetch}),h=(E,x={})=>new Qi(E,x,{provider:`${l}.completion`,url:({path:b})=>`${a}${b}`,headers:u,compatibility:o,fetch:t.fetch}),d=(E,x={})=>new ro(E,x,{provider:`${l}.embedding`,url:({path:b})=>`${a}${b}`,headers:u,fetch:t.fetch}),v=(E,x={})=>new ao(E,x,{provider:`${l}.image`,url:({path:b})=>`${a}${b}`,headers:u,fetch:t.fetch}),g=(E,x)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return E==="gpt-3.5-turbo-instruct"?h(E,x):f(E,x)},w=function(E,x){return g(E,x)};return w.languageModel=g,w.chat=f,w.completion=h,w.embedding=d,w.textEmbedding=d,w.textEmbeddingModel=d,w.image=v,w}ss({compatibility:"strict"});class jt{cachedDynamicModels;getApiKeyLink;labelForGetApiKey;icon;getProviderBaseUrlAndKey(e){const{apiKeys:r,providerSettings:n,serverEnv:a,defaultBaseUrlKey:o,defaultApiTokenKey:l}=e;let u=n?.baseUrl;const f=Be.getInstance();u&&u.length==0&&(u=void 0);const h=this.config.baseUrlKey||o;let d=u||a?.[h]||nt?.env?.[h]||f.env?.[h]||this.config.baseUrl;d&&d.endsWith("/")&&(d=d.slice(0,-1));const v=this.config.apiTokenKey||l,g=r?.[this.name]||a?.[v]||nt?.env?.[v]||f.env?.[v];return{baseUrl:d,apiKey:g}}getModelsFromCache(e){if(!this.cachedDynamicModels)return null;const r=this.cachedDynamicModels.cacheId,n=this.getDynamicModelsCacheKey(e);return r!==n?(this.cachedDynamicModels=void 0,null):this.cachedDynamicModels.models}getDynamicModelsCacheKey(e){return JSON.stringify({apiKeys:e.apiKeys?.[this.name],providerSettings:e.providerSettings?.[this.name],serverEnv:e.serverEnv})}storeDynamicModels(e,r){const n=this.getDynamicModelsCacheKey(e);this.cachedDynamicModels={cacheId:n,models:r}}}let oo=(t,e=21)=>(r=e)=>{let n="",a=r;for(;a--;)n+=t[Math.random()*t.length|0];return n};var as="vercel.ai.error",lo=Symbol.for(as),is,co=class os extends Error{constructor({name:e,message:r,cause:n}){super(r),this[is]=!0,this.name=e,this.cause=n}static isInstance(e){return os.hasMarker(e,as)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}toJSON(){return{name:this.name,message:this.message}}};is=lo;var le=co,ar="AI_APICallError",ls=`vercel.ai.error.${ar}`,uo=Symbol.for(ls),cs,xe=class extends le{constructor({message:e,url:r,requestBodyValues:n,statusCode:a,responseHeaders:o,responseBody:l,cause:u,isRetryable:f=a!=null&&(a===408||a===409||a===429||a>=500),data:h}){super({name:ar,message:e,cause:u}),this[cs]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=a,this.responseHeaders=o,this.responseBody=l,this.isRetryable=f,this.data=h}static isInstance(e){return le.hasMarker(e,ls)}static isAPICallError(e){return e instanceof Error&&e.name===ar&&typeof e.url=="string"&&typeof e.requestBodyValues=="object"&&(e.statusCode==null||typeof e.statusCode=="number")&&(e.responseHeaders==null||typeof e.responseHeaders=="object")&&(e.responseBody==null||typeof e.responseBody=="string")&&(e.cause==null||typeof e.cause=="object")&&typeof e.isRetryable=="boolean"&&(e.data==null||typeof e.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};cs=uo;var ir="AI_EmptyResponseBodyError",us=`vercel.ai.error.${ir}`,po=Symbol.for(us),ds,ho=class extends le{constructor({message:e="Empty response body"}={}){super({name:ir,message:e}),this[ds]=!0}static isInstance(e){return le.hasMarker(e,us)}static isEmptyResponseBodyError(e){return e instanceof Error&&e.name===ir}};ds=po;function ps(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var or="AI_JSONParseError",hs=`vercel.ai.error.${or}`,fo=Symbol.for(hs),fs,$t=class extends le{constructor({text:e,cause:r}){super({name:or,message:`JSON parsing failed: Text: ${e}.
Error message: ${ps(r)}`,cause:r}),this[fs]=!0,this.text=e}static isInstance(e){return le.hasMarker(e,hs)}static isJSONParseError(e){return e instanceof Error&&e.name===or&&typeof e.text=="string"&&typeof e.cause=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};fs=fo;var lr="AI_LoadAPIKeyError",ms=`vercel.ai.error.${lr}`,mo=Symbol.for(ms),gs,ut=class extends le{constructor({message:e}){super({name:lr,message:e}),this[gs]=!0}static isInstance(e){return le.hasMarker(e,ms)}static isLoadAPIKeyError(e){return e instanceof Error&&e.name===lr}};gs=mo;var cr="AI_TypeValidationError",ys=`vercel.ai.error.${cr}`,go=Symbol.for(ys),vs,rt=class extends le{constructor({value:e,cause:r}){super({name:cr,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${ps(r)}`,cause:r}),this[vs]=!0,this.value=e}static isInstance(e){return le.hasMarker(e,ys)}static isTypeValidationError(e){return e instanceof Error&&e.name===cr}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};vs=go;var ur="AI_UnsupportedFunctionalityError",_s=`vercel.ai.error.${ur}`,yo=Symbol.for(_s),ws,dr=class extends le{constructor({functionality:e}){super({name:ur,message:`'${e}' functionality not supported.`}),this[ws]=!0,this.functionality=e}static isInstance(e){return le.hasMarker(e,_s)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===ur&&typeof e.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};ws=yo;function vo(t){let e,r,n,a,o,l,u;return f(),{feed:h,reset:f};function f(){e=!0,r="",n=0,a=-1,o=void 0,l=void 0,u=""}function h(v){r=r?r+v:v,e&&_o(r)&&(r=r.slice(xs.length)),e=!1;const g=r.length;let w=0,E=!1;for(;w<g;){E&&(r[w]===`
`&&++w,E=!1);let x=-1,b=a,$;for(let B=n;x<0&&B<g;++B)$=r[B],$===":"&&b<0?b=B-w:$==="\r"?(E=!0,x=B-w):$===`
`&&(x=B-w);if(x<0){n=g-w,a=b;break}else n=0,a=-1;d(r,w,b,x),w+=x+1}w===g?r="":w>0&&(r=r.slice(w))}function d(v,g,w,E){if(E===0){u.length>0&&(t({type:"event",id:o,event:l||void 0,data:u.slice(0,-1)}),u="",o=void 0),l=void 0;return}const x=w<0,b=v.slice(g,g+(x?E:w));let $=0;x?$=E:v[g+w+1]===" "?$=w+2:$=w+1;const B=g+$,D=E-$,H=v.slice(B,B+D).toString();if(b==="data")u+=H?"".concat(H,`
`):`
`;else if(b==="event")l=H;else if(b==="id"&&!H.includes("\0"))o=H;else if(b==="retry"){const U=parseInt(H,10);Number.isNaN(U)||t({type:"reconnect-interval",value:U})}}}const xs=[239,187,191];function _o(t){return xs.every((e,r)=>t.charCodeAt(r)===e)}class bs extends TransformStream{constructor(){let e;super({start(r){e=vo(n=>{n.type==="event"&&r.enqueue(n)})},transform(r){e.feed(r)}})}}var wo={};function tn(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function Ft(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}function Gt(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function xo({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new ut({message:`${n} API key must be a string.`});if(typeof nt>"u")throw new ut({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=wo[e],t==null)throw new ut({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new ut({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var pr=Symbol.for("vercel.ai.validator");function bo(t){return{[pr]:!0,validate:t}}function ko(t){return typeof t=="object"&&t!==null&&pr in t&&t[pr]===!0&&"validate"in t}function Eo(t){return bo(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function To({value:t,schema:e}){const r=ks({value:t,schema:e});if(!r.success)throw new rt({value:t,cause:r.error});return r.value}function ks({value:t,schema:e}){const r=ko(e)?e:Eo(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:new rt({value:t,cause:n.error})}}catch(n){return{success:!1,error:rt.isTypeValidationError(n)?n:new rt({value:t,cause:n})}}}function Io({text:t,schema:e}){try{const r=Fe.parse(t);return e==null?r:To({value:r,schema:e})}catch(r){throw $t.isJSONParseError(r)||rt.isTypeValidationError(r)?r:new $t({text:t,cause:r})}}function Es({text:t,schema:e}){try{const r=Fe.parse(t);return e==null?{success:!0,value:r}:ks({value:r,schema:e})}catch(r){return{success:!1,error:$t.isJSONParseError(r)?r:new $t({text:t,cause:r})}}}function Ao(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var Co=()=>fetch,rn=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:a,abortSignal:o,fetch:l})=>So({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:a,abortSignal:o,fetch:l}),So=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:a,abortSignal:o,fetch:l=Co()})=>{try{const u=await l(t,{method:"POST",headers:Ao(e),body:r.content,signal:o}),f=Ft(u);if(!u.ok){let h;try{h=await a({response:u,url:t,requestBodyValues:r.values})}catch(d){throw Gt(d)||xe.isAPICallError(d)?d:new xe({message:"Failed to process error response",cause:d,statusCode:u.status,url:t,responseHeaders:f,requestBodyValues:r.values})}throw h.value}try{return await n({response:u,url:t,requestBodyValues:r.values})}catch(h){throw h instanceof Error&&(Gt(h)||xe.isAPICallError(h))?h:new xe({message:"Failed to process successful response",cause:h,statusCode:u.status,url:t,responseHeaders:f,requestBodyValues:r.values})}}catch(u){if(Gt(u))throw u;if(u instanceof TypeError&&u.message==="fetch failed"){const f=u.cause;if(f!=null)throw new xe({message:`Cannot connect to API: ${f.message}`,cause:f,url:t,requestBodyValues:r.values,isRetryable:!0})}throw u}},$o=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:a,requestBodyValues:o})=>{const l=await n.text(),u=Ft(n);if(l.trim()==="")return{responseHeaders:u,value:new xe({message:n.statusText,url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r?.(n)})};try{const f=Io({text:l,schema:t});return{responseHeaders:u,value:new xe({message:e(f),url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,data:f,isRetryable:r?.(n,f)})}}catch{return{responseHeaders:u,value:new xe({message:n.statusText,url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r?.(n)})}}},Ro=t=>async({response:e})=>{const r=Ft(e);if(e.body==null)throw new ho({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new bs).pipeThrough(new TransformStream({transform({data:n},a){n!=="[DONE]"&&a.enqueue(Es({text:n,schema:t}))}}))}},Oo=t=>async({response:e,url:r,requestBodyValues:n})=>{const a=await e.text(),o=Es({text:a,schema:t}),l=Ft(e);if(!o.success)throw new xe({message:"Invalid JSON response",cause:o.error,statusCode:e.status,responseHeaders:l,responseBody:a,url:r,requestBodyValues:n});return{responseHeaders:l,value:o.value}};function Bo(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return globalThis.btoa(e)}function No(t){return t?.replace(/\/$/,"")}var Po=I({type:Y("error"),error:I({type:S(),message:S()})}),nn=$o({errorSchema:Po,errorToMessage:t=>t.error.message});function Mo(t){var e;const r=jo(t);let n;const a=[];for(let o=0;o<r.length;o++){const l=r[o],u=l.type;switch(u){case"system":{if(n!=null)throw new dr({functionality:"Multiple system messages that are separated by user/assistant messages"});n=l.messages.map(({content:f})=>f).join(`
`);break}case"user":{const f=[];for(const{role:h,content:d}of l.messages)switch(h){case"user":{for(const v of d)switch(v.type){case"text":{f.push({type:"text",text:v.text});break}case"image":{if(v.image instanceof URL)throw new dr({functionality:"Image URLs in user messages"});f.push({type:"image",source:{type:"base64",media_type:(e=v.mimeType)!=null?e:"image/jpeg",data:Bo(v.image)}});break}}break}case"tool":{for(const v of d)f.push({type:"tool_result",tool_use_id:v.toolCallId,content:JSON.stringify(v.result),is_error:v.isError});break}default:{const v=h;throw new Error(`Unsupported role: ${v}`)}}a.push({role:"user",content:f});break}case"assistant":{const f=[];for(const{content:h}of l.messages)for(let d=0;d<h.length;d++){const v=h[d];switch(v.type){case"text":{f.push({type:"text",text:o===r.length-1&&d===l.messages.length-1?v.text.trim():v.text});break}case"tool-call":{f.push({type:"tool_use",id:v.toolCallId,name:v.toolName,input:v.args});break}}}a.push({role:"assistant",content:f});break}default:{const f=u;throw new Error(`Unsupported type: ${f}`)}}}return{system:n,messages:a}}function jo(t){const e=[];let r;for(const{role:n,content:a}of t)switch(n){case"system":{r?.type!=="system"&&(r={type:"system",messages:[]},e.push(r)),r.messages.push({role:n,content:a});break}case"assistant":{r?.type!=="assistant"&&(r={type:"assistant",messages:[]},e.push(r)),r.messages.push({role:n,content:a});break}case"user":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push({role:n,content:a});break}case"tool":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push({role:n,content:a});break}default:{const o=n;throw new Error(`Unsupported role: ${o}`)}}return e}function sn(t){switch(t){case"end_turn":case"stop_sequence":return"stop";case"tool_use":return"tool-calls";case"max_tokens":return"length";default:return"other"}}var Fo=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}async getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:a,topK:o,frequencyPenalty:l,presencePenalty:u,stopSequences:f,responseFormat:h,seed:d}){const v=t.type,g=[];l!=null&&g.push({type:"unsupported-setting",setting:"frequencyPenalty"}),u!=null&&g.push({type:"unsupported-setting",setting:"presencePenalty"}),d!=null&&g.push({type:"unsupported-setting",setting:"seed"}),h!=null&&h.type!=="text"&&g.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const w=Mo(e),E={model:this.modelId,top_k:o??this.settings.topK,max_tokens:r??4096,temperature:n,top_p:a,stop_sequences:f,system:w.system,messages:w.messages};switch(v){case"regular":return{args:{...E,...Do(t)},warnings:g};case"object-json":throw new dr({functionality:"json-mode object generation"});case"object-tool":{const{name:x,description:b,parameters:$}=t.tool;return{args:{...E,tools:[{name:x,description:b,input_schema:$}],tool_choice:{type:"tool",name:x}},warnings:g}}default:{const x=v;throw new Error(`Unsupported type: ${x}`)}}}async doGenerate(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:a}=await rn({url:`${this.config.baseURL}/messages`,headers:tn(this.config.headers(),t.headers),body:e,failedResponseHandler:nn,successfulResponseHandler:Oo(Uo),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:o,...l}=e;let u="";for(const h of a.content)h.type==="text"&&(u+=h.text);let f;if(a.content.some(h=>h.type==="tool_use")){f=[];for(const h of a.content)h.type==="tool_use"&&f.push({toolCallType:"function",toolCallId:h.id,toolName:h.name,args:JSON.stringify(h.input)})}return{text:u,toolCalls:f,finishReason:sn(a.stop_reason),usage:{promptTokens:a.usage.input_tokens,completionTokens:a.usage.output_tokens},rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:n},warnings:r}}async doStream(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:a}=await rn({url:`${this.config.baseURL}/messages`,headers:tn(this.config.headers(),t.headers),body:{...e,stream:!0},failedResponseHandler:nn,successfulResponseHandler:Ro(Lo),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:o,...l}=e;let u="other";const f={promptTokens:Number.NaN,completionTokens:Number.NaN},h={};return{stream:a.pipeThrough(new TransformStream({transform(d,v){if(!d.success){v.enqueue({type:"error",error:d.error});return}const g=d.value;switch(g.type){case"ping":return;case"content_block_start":{const w=g.content_block.type;switch(w){case"text":return;case"tool_use":{h[g.index]={toolCallId:g.content_block.id,toolName:g.content_block.name,jsonText:""};return}default:{const E=w;throw new Error(`Unsupported content block type: ${E}`)}}}case"content_block_stop":{if(h[g.index]!=null){const w=h[g.index];v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,args:w.jsonText}),delete h[g.index]}return}case"content_block_delta":{const w=g.delta.type;switch(w){case"text_delta":{v.enqueue({type:"text-delta",textDelta:g.delta.text});return}case"input_json_delta":{const E=h[g.index];v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:E.toolCallId,toolName:E.toolName,argsTextDelta:g.delta.partial_json}),E.jsonText+=g.delta.partial_json;return}default:{const E=w;throw new Error(`Unsupported delta type: ${E}`)}}}case"message_start":{f.promptTokens=g.message.usage.input_tokens,f.completionTokens=g.message.usage.output_tokens;return}case"message_delta":{f.completionTokens=g.usage.output_tokens,u=sn(g.delta.stop_reason);return}case"message_stop":{v.enqueue({type:"finish",finishReason:u,usage:f});return}case"error":{v.enqueue({type:"error",error:g.error});return}default:{const w=g;throw new Error(`Unsupported chunk type: ${w}`)}}}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:n},warnings:r}}},Uo=I({type:Y("message"),content:Z(pt("type",[I({type:Y("text"),text:S()}),I({type:Y("tool_use"),id:S(),name:S(),input:es()})])),stop_reason:S().optional().nullable(),usage:I({input_tokens:N(),output_tokens:N()})}),Lo=pt("type",[I({type:Y("message_start"),message:I({usage:I({input_tokens:N(),output_tokens:N()})})}),I({type:Y("content_block_start"),index:N(),content_block:pt("type",[I({type:Y("text"),text:S()}),I({type:Y("tool_use"),id:S(),name:S()})])}),I({type:Y("content_block_delta"),index:N(),delta:pt("type",[I({type:Y("input_json_delta"),partial_json:S()}),I({type:Y("text_delta"),text:S()})])}),I({type:Y("content_block_stop"),index:N()}),I({type:Y("error"),error:I({type:S(),message:S()})}),I({type:Y("message_delta"),delta:I({stop_reason:S().optional().nullable()}),usage:I({output_tokens:N()})}),I({type:Y("message_stop")}),I({type:Y("ping")})]);function Do(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,tool_choice:void 0};const n=r.map(l=>({name:l.name,description:l.description,input_schema:l.parameters})),a=t.toolChoice;if(a==null)return{tools:n,tool_choice:void 0};const o=a.type;switch(o){case"auto":return{tools:n,tool_choice:{type:"auto"}};case"required":return{tools:n,tool_choice:{type:"any"}};case"none":return{tools:void 0,tool_choice:void 0};case"tool":return{tools:n,tool_choice:{type:"tool",name:a.toolName}};default:{const l=o;throw new Error(`Unsupported tool choice type: ${l}`)}}}function Ts(t={}){var e,r;const n=(r=No((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://api.anthropic.com/v1",a=()=>({"anthropic-version":"2023-06-01","x-api-key":xo({apiKey:t.apiKey,environmentVariableName:"ANTHROPIC_API_KEY",description:"Anthropic"}),...t.headers}),o=(u,f={})=>new Fo(u,f,{provider:"anthropic.messages",baseURL:n,headers:a,fetch:t.fetch}),l=function(u,f){if(new.target)throw new Error("The Anthropic model function cannot be called with the new keyword.");return o(u,f)};return l.languageModel=o,l.chat=o,l.messages=o,l}Ts();class Vo extends jt{name="Anthropic";getApiKeyLink="https://console.anthropic.com/settings/keys";config={apiTokenKey:"ANTHROPIC_API_KEY"};staticModels=[{name:"claude-opus-4-6-20260205",label:"Claude Opus 4.6",provider:"Anthropic",maxTokenAllowed:1e6,maxCompletionTokens:128e3},{name:"claude-opus-4-5-20251124",label:"Claude Opus 4.5",provider:"Anthropic",maxTokenAllowed:2e5,maxCompletionTokens:64e3},{name:"claude-sonnet-4-5-20250929",label:"Claude Sonnet 4.5",provider:"Anthropic",maxTokenAllowed:2e5,maxCompletionTokens:64e3},{name:"claude-haiku-4-5-20251015",label:"Claude Haiku 4.5",provider:"Anthropic",maxTokenAllowed:2e5,maxCompletionTokens:32e3},{name:"claude-opus-4-1-20250805",label:"Claude Opus 4.1",provider:"Anthropic",maxTokenAllowed:2e5,maxCompletionTokens:32e3},{name:"claude-3-5-sonnet-20241022",label:"Claude 3.5 Sonnet",provider:"Anthropic",maxTokenAllowed:2e5,maxCompletionTokens:8192}];async getDynamicModels(e,r,n){const{apiKey:a}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"ANTHROPIC_API_KEY"});if(!a)throw`Missing Api Key configuration for ${this.name} provider`;const l=await(await fetch("https://api.anthropic.com/v1/models",{headers:{"x-api-key":`${a}`,"anthropic-version":"2023-06-01"}})).json(),u=this.staticModels.map(h=>h.name);return l.data.filter(h=>h.type==="model"&&!u.includes(h.id)).map(h=>{let d=32e3;h.max_tokens?d=h.max_tokens:(h.id?.includes("claude-3-5-sonnet")||h.id?.includes("claude-3-haiku")||h.id?.includes("claude-3-opus")||h.id?.includes("claude-3-sonnet"))&&(d=2e5);let v=128e3;return h.id?.includes("claude-opus-4")?v=32e3:h.id?.includes("claude-sonnet-4")?v=64e3:h.id?.includes("claude-4")&&(v=32e3),{name:h.id,label:`${h.display_name} (${Math.floor(d/1e3)}k context)`,provider:this.name,maxTokenAllowed:d,maxCompletionTokens:v}})}getModelInstance=e=>{const{apiKeys:r,providerSettings:n,serverEnv:a,model:o}=e,{apiKey:l}=this.getProviderBaseUrlAndKey({apiKeys:r,providerSettings:n,serverEnv:a,defaultBaseUrlKey:"",defaultApiTokenKey:"ANTHROPIC_API_KEY"});return Ts({apiKey:l,headers:{"anthropic-beta":"output-128k-2025-02-19"}})(o)}}var Is="vercel.ai.error",Ko=Symbol.for(Is),As,Zo=class Cs extends Error{constructor({name:e,message:r,cause:n}){super(r),this[As]=!0,this.name=e,this.cause=n}static isInstance(e){return Cs.hasMarker(e,Is)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}toJSON(){return{name:this.name,message:this.message}}};As=Ko;var ie=Zo,hr="AI_APICallError",Ss=`vercel.ai.error.${hr}`,qo=Symbol.for(Ss),$s,be=class extends ie{constructor({message:t,url:e,requestBodyValues:r,statusCode:n,responseHeaders:a,responseBody:o,cause:l,isRetryable:u=n!=null&&(n===408||n===409||n===429||n>=500),data:f}){super({name:hr,message:t,cause:l}),this[$s]=!0,this.url=e,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=a,this.responseBody=o,this.isRetryable=u,this.data=f}static isInstance(t){return ie.hasMarker(t,Ss)}static isAPICallError(t){return t instanceof Error&&t.name===hr&&typeof t.url=="string"&&typeof t.requestBodyValues=="object"&&(t.statusCode==null||typeof t.statusCode=="number")&&(t.responseHeaders==null||typeof t.responseHeaders=="object")&&(t.responseBody==null||typeof t.responseBody=="string")&&(t.cause==null||typeof t.cause=="object")&&typeof t.isRetryable=="boolean"&&(t.data==null||typeof t.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};$s=qo;var fr="AI_EmptyResponseBodyError",Rs=`vercel.ai.error.${fr}`,Ho=Symbol.for(Rs),Os,Jo=class extends ie{constructor({message:t="Empty response body"}={}){super({name:fr,message:t}),this[Os]=!0}static isInstance(t){return ie.hasMarker(t,Rs)}static isEmptyResponseBodyError(t){return t instanceof Error&&t.name===fr}};Os=Ho;function Bs(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var mr="AI_JSONParseError",Ns=`vercel.ai.error.${mr}`,Go=Symbol.for(Ns),Ps,Rt=class extends ie{constructor({text:t,cause:e}){super({name:mr,message:`JSON parsing failed: Text: ${t}.
Error message: ${Bs(e)}`,cause:e}),this[Ps]=!0,this.text=t}static isInstance(t){return ie.hasMarker(t,Ns)}static isJSONParseError(t){return t instanceof Error&&t.name===mr&&"text"in t&&typeof t.text=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};Ps=Go;var gr="AI_LoadAPIKeyError",Ms=`vercel.ai.error.${gr}`,zo=Symbol.for(Ms),js,dt=class extends ie{constructor({message:t}){super({name:gr,message:t}),this[js]=!0}static isInstance(t){return ie.hasMarker(t,Ms)}static isLoadAPIKeyError(t){return t instanceof Error&&t.name===gr}};js=zo;var yr="AI_TooManyEmbeddingValuesForCallError",Fs=`vercel.ai.error.${yr}`,Wo=Symbol.for(Fs),Us,Yo=class extends ie{constructor(t){super({name:yr,message:`Too many values for a single embedding call. The ${t.provider} model "${t.modelId}" can only embed up to ${t.maxEmbeddingsPerCall} values per call, but ${t.values.length} values were provided.`}),this[Us]=!0,this.provider=t.provider,this.modelId=t.modelId,this.maxEmbeddingsPerCall=t.maxEmbeddingsPerCall,this.values=t.values}static isInstance(t){return ie.hasMarker(t,Fs)}static isTooManyEmbeddingValuesForCallError(t){return t instanceof Error&&t.name===yr&&"provider"in t&&typeof t.provider=="string"&&"modelId"in t&&typeof t.modelId=="string"&&"maxEmbeddingsPerCall"in t&&typeof t.maxEmbeddingsPerCall=="number"&&"values"in t&&Array.isArray(t.values)}toJSON(){return{name:this.name,message:this.message,stack:this.stack,provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:this.values}}};Us=Wo;var vr="AI_TypeValidationError",Ls=`vercel.ai.error.${vr}`,Xo=Symbol.for(Ls),Ds,Qo=class _r extends ie{constructor({value:e,cause:r}){super({name:vr,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${Bs(r)}`,cause:r}),this[Ds]=!0,this.value=e}static isInstance(e){return ie.hasMarker(e,Ls)}static wrap({value:e,cause:r}){return _r.isInstance(r)&&r.value===e?r:new _r({value:e,cause:r})}static isTypeValidationError(e){return e instanceof Error&&e.name===vr}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};Ds=Xo;var Ot=Qo,wr="AI_UnsupportedFunctionalityError",Vs=`vercel.ai.error.${wr}`,el=Symbol.for(Vs),Ks,zt=class extends ie{constructor({functionality:t}){super({name:wr,message:`'${t}' functionality not supported.`}),this[Ks]=!0,this.functionality=t}static isInstance(t){return ie.hasMarker(t,Vs)}static isUnsupportedFunctionalityError(t){return t instanceof Error&&t.name===wr&&typeof t.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};Ks=el;var tl={};function xr(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function Ut(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var rl=({prefix:t="",size:e=7,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}={})=>{const n=oo(r,e);return a=>`${t}${n(a)}`},nl=rl();function Wt(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function sl({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new dt({message:`${n} API key must be a string.`});if(typeof nt>"u")throw new dt({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=tl[e],t==null)throw new dt({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new dt({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var br=Symbol.for("vercel.ai.validator");function al(t){return{[br]:!0,validate:t}}function il(t){return typeof t=="object"&&t!==null&&br in t&&t[br]===!0&&"validate"in t}function ol(t){return il(t)?t:ll(t)}function ll(t){return al(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function cl({value:t,schema:e}){const r=Zs({value:t,schema:e});if(!r.success)throw Ot.wrap({value:t,cause:r.error});return r.value}function Zs({value:t,schema:e}){const r=ol(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:Ot.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:Ot.wrap({value:t,cause:n})}}}function ul({text:t,schema:e}){try{const r=Fe.parse(t);return e==null?r:cl({value:r,schema:e})}catch(r){throw Rt.isJSONParseError(r)||Ot.isTypeValidationError(r)?r:new Rt({text:t,cause:r})}}function qs({text:t,schema:e}){try{const r=Fe.parse(t);return e==null?{success:!0,value:r}:Zs({value:r,schema:e})}catch(r){return{success:!1,error:Rt.isJSONParseError(r)?r:new Rt({text:t,cause:r})}}}function dl(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var pl=()=>globalThis.fetch,kr=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:a,abortSignal:o,fetch:l})=>hl({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:a,abortSignal:o,fetch:l}),hl=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:a,abortSignal:o,fetch:l=pl()})=>{try{const u=await l(t,{method:"POST",headers:dl(e),body:r.content,signal:o}),f=Ut(u);if(!u.ok){let h;try{h=await a({response:u,url:t,requestBodyValues:r.values})}catch(d){throw Wt(d)||be.isAPICallError(d)?d:new be({message:"Failed to process error response",cause:d,statusCode:u.status,url:t,responseHeaders:f,requestBodyValues:r.values})}throw h.value}try{return await n({response:u,url:t,requestBodyValues:r.values})}catch(h){throw h instanceof Error&&(Wt(h)||be.isAPICallError(h))?h:new be({message:"Failed to process successful response",cause:h,statusCode:u.status,url:t,responseHeaders:f,requestBodyValues:r.values})}}catch(u){if(Wt(u))throw u;if(u instanceof TypeError&&u.message==="fetch failed"){const f=u.cause;if(f!=null)throw new be({message:`Cannot connect to API: ${f.message}`,cause:f,url:t,requestBodyValues:r.values,isRetryable:!0})}throw u}},fl=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:a,requestBodyValues:o})=>{const l=await n.text(),u=Ut(n);if(l.trim()==="")return{responseHeaders:u,value:new be({message:n.statusText,url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r?.(n)})};try{const f=ul({text:l,schema:t});return{responseHeaders:u,value:new be({message:e(f),url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,data:f,isRetryable:r?.(n,f)})}}catch{return{responseHeaders:u,value:new be({message:n.statusText,url:a,requestBodyValues:o,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r?.(n)})}}},ml=t=>async({response:e})=>{const r=Ut(e);if(e.body==null)throw new Jo({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new bs).pipeThrough(new TransformStream({transform({data:n},a){n!=="[DONE]"&&a.enqueue(qs({text:n,schema:t}))}}))}},Hs=t=>async({response:e,url:r,requestBodyValues:n})=>{const a=await e.text(),o=qs({text:a,schema:t}),l=Ut(e);if(!o.success)throw new be({message:"Invalid JSON response",cause:o.error,statusCode:e.status,responseHeaders:l,responseBody:a,url:r,requestBodyValues:n});return{responseHeaders:l,value:o.value}},{btoa:gl}=globalThis;function yl(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return gl(e)}function vl(t){return t?.replace(/\/$/,"")}function fe(t){if(typeof t=="boolean")return{type:"boolean",properties:{}};const{type:e,description:r,required:n,properties:a,items:o,allOf:l,anyOf:u,oneOf:f,format:h,const:d,minLength:v}=t,g={};return r&&(g.description=r),n&&(g.required=n),h&&(g.format=h),d!==void 0&&(g.enum=[d]),e&&(Array.isArray(e)?e.includes("null")?(g.type=e.filter(w=>w!=="null")[0],g.nullable=!0):g.type=e:e==="null"?g.type="null":g.type=e),a&&(g.properties=Object.entries(a).reduce((w,[E,x])=>(w[E]=fe(x),w),{})),o&&(g.items=Array.isArray(o)?o.map(fe):fe(o)),l&&(g.allOf=l.map(fe)),u&&(g.anyOf=u.map(fe)),f&&(g.oneOf=f.map(fe)),v!==void 0&&(g.minLength=v),g}function _l(t){var e;const r=[],n=[];let a=!0;for(const{role:o,content:l}of t)switch(o){case"system":{if(!a)throw new zt({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:l});break}case"user":{a=!1;const u=[];for(const f of l)switch(f.type){case"text":{u.push({text:f.text});break}case"image":{if(f.image instanceof URL)throw new zt({functionality:"Image URLs in user messages"});u.push({inlineData:{mimeType:(e=f.mimeType)!=null?e:"image/jpeg",data:yl(f.image)}});break}case"file":{if(f.data instanceof URL)throw new zt({functionality:"File URLs in user messages"});u.push({inlineData:{mimeType:f.mimeType,data:f.data}});break}}n.push({role:"user",parts:u});break}case"assistant":{a=!1,n.push({role:"model",parts:l.map(u=>{switch(u.type){case"text":return u.text.length===0?void 0:{text:u.text};case"tool-call":return{functionCall:{name:u.toolName,args:u.args}}}}).filter(u=>u!==void 0)});break}case"tool":{a=!1,n.push({role:"user",parts:l.map(u=>({functionResponse:{name:u.toolName,response:u.result}}))});break}default:{const u=o;throw new Error(`Unsupported role: ${u}`)}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:n}}function an(t){return t.includes("/")?t:`models/${t}`}var wl=I({error:I({code:N().nullable(),message:S(),status:S()})}),Er=fl({errorSchema:wl,errorToMessage:t=>t.error.message});function on({finishReason:t,hasToolCalls:e}){switch(t){case"STOP":return e?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"RECITATION":case"SAFETY":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";default:return"unknown"}}var xl=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get supportsObjectGeneration(){return this.settings.structuredOutputs!==!1}get provider(){return this.config.provider}async getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:a,topK:o,frequencyPenalty:l,presencePenalty:u,stopSequences:f,responseFormat:h,seed:d}){var v;const g=t.type,w=[];d!=null&&w.push({type:"unsupported-setting",setting:"seed"});const E={maxOutputTokens:r,temperature:n,topK:o??this.settings.topK,topP:a,frequencyPenalty:l,presencePenalty:u,stopSequences:f,responseMimeType:h?.type==="json"?"application/json":void 0,responseSchema:h?.type==="json"&&h.schema!=null&&this.supportsObjectGeneration?fe(h.schema):void 0},{contents:x,systemInstruction:b}=_l(e);switch(g){case"regular":return{args:{generationConfig:E,contents:x,systemInstruction:b,safetySettings:this.settings.safetySettings,...El(t),cachedContent:this.settings.cachedContent},warnings:w};case"object-json":return{args:{generationConfig:{...E,responseMimeType:"application/json",responseSchema:t.schema!=null&&this.supportsObjectGeneration?fe(t.schema):void 0},contents:x,systemInstruction:b,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:w};case"object-tool":return{args:{generationConfig:E,contents:x,tools:{functionDeclarations:[{name:t.tool.name,description:(v=t.tool.description)!=null?v:"",parameters:fe(t.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:w};default:{const $=g;throw new Error(`Unsupported type: ${$}`)}}}async doGenerate(t){var e,r;const{args:n,warnings:a}=await this.getArgs(t),{responseHeaders:o,value:l}=await kr({url:`${this.config.baseURL}/${an(this.modelId)}:generateContent`,headers:xr(this.config.headers(),t.headers),body:n,failedResponseHandler:Er,successfulResponseHandler:Hs(bl),abortSignal:t.abortSignal,fetch:this.config.fetch}),{contents:u,...f}=n,h=l.candidates[0],d=ln({parts:h.content.parts,generateId:this.config.generateId}),v=l.usageMetadata;return{text:cn(h.content.parts),toolCalls:d,finishReason:on({finishReason:h.finishReason,hasToolCalls:d!=null&&d.length>0}),usage:{promptTokens:(e=v?.promptTokenCount)!=null?e:NaN,completionTokens:(r=v?.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:u,rawSettings:f},rawResponse:{headers:o},warnings:a}}async doStream(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:a}=await kr({url:`${this.config.baseURL}/${an(this.modelId)}:streamGenerateContent?alt=sse`,headers:xr(this.config.headers(),t.headers),body:e,failedResponseHandler:Er,successfulResponseHandler:ml(kl),abortSignal:t.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=e;let u="unknown",f={promptTokens:Number.NaN,completionTokens:Number.NaN};const h=this.config.generateId;let d=!1;return{stream:a.pipeThrough(new TransformStream({transform(v,g){var w,E;if(!v.success){g.enqueue({type:"error",error:v.error});return}const x=v.value,b=x.candidates[0];b?.finishReason!=null&&(u=on({finishReason:b.finishReason,hasToolCalls:d}));const $=x.usageMetadata;$!=null&&(f={promptTokens:(w=$.promptTokenCount)!=null?w:NaN,completionTokens:(E=$.candidatesTokenCount)!=null?E:NaN});const B=b.content;if(B==null)return;const D=cn(B.parts);D!=null&&g.enqueue({type:"text-delta",textDelta:D});const H=ln({parts:B.parts,generateId:h});if(H!=null)for(const U of H)g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:U.toolCallId,toolName:U.toolName,argsTextDelta:U.args}),g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:U.toolCallId,toolName:U.toolName,args:U.args}),d=!0},flush(v){v.enqueue({type:"finish",finishReason:u,usage:f})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:n},warnings:r}}};function ln({parts:t,generateId:e}){const r=t.filter(n=>"functionCall"in n);return r.length===0?void 0:r.map(n=>({toolCallType:"function",toolCallId:e(),toolName:n.functionCall.name,args:JSON.stringify(n.functionCall.args)}))}function cn(t){const e=t.filter(r=>"text"in r);return e.length===0?void 0:e.map(r=>r.text).join("")}var Js=I({role:S(),parts:Z(Mt([I({text:S()}),I({functionCall:I({name:S(),args:es()})})]))}),bl=I({candidates:Z(I({content:Js,finishReason:S().optional()})),usageMetadata:I({promptTokenCount:N(),candidatesTokenCount:N().nullish(),totalTokenCount:N()}).optional()}),kl=I({candidates:Z(I({content:Js.optional(),finishReason:S().optional()})),usageMetadata:I({promptTokenCount:N(),candidatesTokenCount:N().nullish(),totalTokenCount:N()}).optional()});function El(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,toolConfig:void 0};const n={functionDeclarations:r.map(l=>{var u;return{name:l.name,description:(u=l.description)!=null?u:"",parameters:fe(l.parameters)}})},a=t.toolChoice;if(a==null)return{tools:n,toolConfig:void 0};const o=a.type;switch(o){case"auto":return{tools:n,toolConfig:{functionCallingConfig:{mode:"AUTO"}}};case"none":return{tools:n,toolConfig:{functionCallingConfig:{mode:"NONE"}}};case"required":return{tools:n,toolConfig:{functionCallingConfig:{mode:"ANY"}}};case"tool":return{tools:n,toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[a.toolName]}}};default:{const l=o;throw new Error(`Unsupported tool choice type: ${l}`)}}}var Tl=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:t,headers:e,abortSignal:r}){if(t.length>this.maxEmbeddingsPerCall)throw new Yo({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:a}=await kr({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:xr(this.config.headers(),e),body:{requests:t.map(o=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:o}]},outputDimensionality:this.settings.outputDimensionality}))},failedResponseHandler:Er,successfulResponseHandler:Hs(Il),abortSignal:r,fetch:this.config.fetch});return{embeddings:a.embeddings.map(o=>o.values),usage:void 0,rawResponse:{headers:n}}}},Il=I({embeddings:Z(I({values:Z(N())}))});function Gs(t={}){var e,r;const n=(r=vl((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://generativelanguage.googleapis.com/v1beta",a=()=>({"x-goog-api-key":sl({apiKey:t.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...t.headers}),o=(f,h={})=>{var d;return new xl(f,h,{provider:"google.generative-ai",baseURL:n,headers:a,generateId:(d=t.generateId)!=null?d:nl,fetch:t.fetch})},l=(f,h={})=>new Tl(f,h,{provider:"google.generative-ai",baseURL:n,headers:a,fetch:t.fetch}),u=function(f,h){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return o(f,h)};return u.languageModel=o,u.chat=o,u.generativeAI=o,u.embedding=l,u.textEmbedding=l,u.textEmbeddingModel=l,u}Gs();class Al extends jt{name="Google";getApiKeyLink="https://aistudio.google.com/app/apikey";config={apiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"};staticModels=[{name:"gemini-3-pro-preview",label:"Gemini 3 Pro",provider:"Google",maxTokenAllowed:2e6,maxCompletionTokens:32768},{name:"gemini-3-flash-preview",label:"Gemini 3 Flash",provider:"Google",maxTokenAllowed:1e6,maxCompletionTokens:16384},{name:"gemini-2.5-pro",label:"Gemini 2.5 Pro",provider:"Google",maxTokenAllowed:1e6,maxCompletionTokens:8192},{name:"gemini-2.5-flash",label:"Gemini 2.5 Flash",provider:"Google",maxTokenAllowed:1e6,maxCompletionTokens:8192}];async getDynamicModels(e,r,n){const{apiKey:a}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"});if(!a)throw`Missing Api Key configuration for ${this.name} provider`;const o=await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${a}`,{headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error(`Failed to fetch models from Google API: ${o.status} ${o.statusText}`);const l=await o.json();if(!l.models||!Array.isArray(l.models))throw new Error("Invalid response format from Google API");return l.models.filter(f=>{const h=(f.outputTokenLimit||0)>8e3,d=!f.name.includes("exp")||f.name.includes("flash-exp");return h&&d}).map(f=>{const h=f.name.replace("models/","");let d=32e3;f.inputTokenLimit&&f.outputTokenLimit?d=f.inputTokenLimit:h.includes("gemini-1.5-pro")?d=2e6:h.includes("gemini-1.5-flash")||h.includes("gemini-2.0-flash")?d=1e6:(h.includes("gemini-pro")||h.includes("gemini-flash"))&&(d=32e3);const g=Math.min(d,2e6);let w=8192;return f.outputTokenLimit&&f.outputTokenLimit>0&&(w=Math.min(f.outputTokenLimit,128e3)),{name:h,label:`${f.displayName} (${g>=1e6?Math.floor(g/1e6)+"M":Math.floor(g/1e3)+"k"} context)`,provider:this.name,maxTokenAllowed:g,maxCompletionTokens:w}})}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:a,providerSettings:o}=e,{apiKey:l}=this.getProviderBaseUrlAndKey({apiKeys:a,providerSettings:o?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"});if(!l)throw new Error(`Missing API key for ${this.name} provider`);return Gs({apiKey:l})(r)}}class Cl extends jt{name="OpenAI";getApiKeyLink="https://platform.openai.com/api-keys";config={apiTokenKey:"OPENAI_API_KEY"};staticModels=[{name:"gpt-5.2",label:"GPT-5.2",provider:"OpenAI",maxTokenAllowed:256e3,maxCompletionTokens:32768},{name:"gpt-5",label:"GPT-5",provider:"OpenAI",maxTokenAllowed:128e3,maxCompletionTokens:16384},{name:"gpt-5-mini",label:"GPT-5 Mini",provider:"OpenAI",maxTokenAllowed:128e3,maxCompletionTokens:8192},{name:"gpt-4.1",label:"GPT-4.1",provider:"OpenAI",maxTokenAllowed:128e3,maxCompletionTokens:16384},{name:"gpt-4.1-mini",label:"GPT-4.1 Mini",provider:"OpenAI",maxTokenAllowed:128e3,maxCompletionTokens:8192}];async getDynamicModels(e,r,n){const{apiKey:a}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"OPENAI_API_KEY"});if(!a)throw`Missing Api Key configuration for ${this.name} provider`;const l=await(await fetch("https://api.openai.com/v1/models",{headers:{Authorization:`Bearer ${a}`}})).json(),u=this.staticModels.map(h=>h.name);return l.data.filter(h=>h.object==="model"&&(h.id.startsWith("gpt-")||h.id.startsWith("o")||h.id.startsWith("chatgpt-"))&&!u.includes(h.id)).map(h=>{let d=32e3;h.context_length?d=h.context_length:h.id?.includes("gpt-4o")||h.id?.includes("gpt-4-turbo")||h.id?.includes("gpt-4-1106")?d=128e3:h.id?.includes("gpt-4")?d=8192:h.id?.includes("gpt-3.5-turbo")&&(d=16385);let v=4096;return h.id?.startsWith("o1-preview")?v=32e3:h.id?.startsWith("o1-mini")?v=65e3:h.id?.startsWith("o1")?v=32e3:h.id?.includes("o3")||h.id?.includes("o4")?v=1e5:h.id?.includes("gpt-4o")?v=4096:h.id?.includes("gpt-4")?v=8192:h.id?.includes("gpt-3.5-turbo")&&(v=4096),{name:h.id,label:`${h.id} (${Math.floor(d/1e3)}k context)`,provider:this.name,maxTokenAllowed:Math.min(d,128e3),maxCompletionTokens:v}})}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:a,providerSettings:o}=e,{apiKey:l}=this.getProviderBaseUrlAndKey({apiKeys:a,providerSettings:o?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"OPENAI_API_KEY"});if(!l)throw new Error(`Missing API key for ${this.name} provider`);return ss({apiKey:l})(r)}}const Sl=Object.freeze(Object.defineProperty({__proto__:null,AnthropicProvider:Vo,GoogleProvider:Al,OpenAIProvider:Cl},Symbol.toStringTag,{value:"Module"})),he=sa("LLMManager");class Be{static _instance;_providers=new Map;_modelList=[];_env={};constructor(e){this._registerProvidersFromDirectory(),this._env=e}static getInstance(e={}){return Be._instance||(Be._instance=new Be(e)),Be._instance}get env(){return this._env}async _registerProvidersFromDirectory(){try{for(const e of Object.values(Sl))if(typeof e=="function"&&e.prototype instanceof jt){const r=new e;try{this.registerProvider(r)}catch(n){he.warn("Failed To Register Provider: ",r.name,"error:",n.message)}}this.logProviderSummary()}catch(e){he.error("Error registering providers:",e)}}registerProvider(e){if(this._providers.has(e.name)){he.warn(`Provider ${e.name} is already registered. Skipping.`);return}this._providers.set(e.name,e),this._modelList=[...this._modelList,...e.staticModels]}logProviderSummary(){const e=Array.from(this._providers.keys());he.info(`Registered ${e.length} providers: ${e.join(", ")}`)}getProvider(e){return this._providers.get(e)}getAllProviders(){return Array.from(this._providers.values())}getModelList(){return this._modelList}async updateModelList(e){const{apiKeys:r,providerSettings:n,serverEnv:a}=e;let o=Array.from(this._providers.values()).map(g=>g.name);n&&Object.keys(n).length>0&&(o=o.filter(g=>n[g].enabled));const l=await Promise.all(Array.from(this._providers.values()).filter(g=>o.includes(g.name)).filter(g=>!!g.getDynamicModels).map(async g=>{const w=g.getModelsFromCache(e);return w||await g.getDynamicModels(r,n?.[g.name],a).then(x=>(he.info(`Caching ${x.length} dynamic models for ${g.name}`),g.storeDynamicModels(e,x),x)).catch(x=>(he.error(`Error getting dynamic models ${g.name} :`,x),[]))})),u=Array.from(this._providers.values()).flatMap(g=>g.staticModels||[]),f=l.flat(),h=f.map(g=>`${g.name}-${g.provider}`),d=u.filter(g=>!h.includes(`${g.name}-${g.provider}`)),v=[...f,...d];return v.sort((g,w)=>g.name.localeCompare(w.name)),this._modelList=v,v}getStaticModelList(){return[...this._providers.values()].flatMap(e=>e.staticModels||[])}async getModelListFromProvider(e,r){const n=this._providers.get(e.name);if(!n)throw new Error(`Provider ${e.name} not found`);const a=n.staticModels||[];if(!n.getDynamicModels)return a;const{apiKeys:o,providerSettings:l,serverEnv:u}=r,f=n.getModelsFromCache({apiKeys:o,providerSettings:l,serverEnv:u});if(f)return he.info(`Found ${f.length} cached models for ${n.name}`),[...f,...a];he.info(`Getting dynamic models for ${n.name}`);const h=await n.getDynamicModels?.(o,l?.[n.name],u).then(w=>(he.info(`Got ${w.length} dynamic models for ${n.name}`),n.storeDynamicModels(r,w),w)).catch(w=>(he.error(`Error getting dynamic models ${n.name} :`,w),[])),d=h.map(w=>w.name),v=a.filter(w=>!d.includes(w.name)),g=[...h,...v];return g.sort((w,E)=>w.name.localeCompare(E.name)),g}getStaticModelListFromProvider(e){const r=this._providers.get(e.name);if(!r)throw new Error(`Provider ${e.name} not found`);return[...r.staticModels||[]]}getDefaultProvider(){const e=this._providers.values().next().value;if(!e)throw new Error("No providers registered");return e}}const $l={BASE_URL:"/",DEV:!0,LMSTUDIO_API_BASE_URL:"http://127.0.0.1:1234",MODE:"production",OLLAMA_API_BASE_URL:"http://127.0.0.1:11434",OPENAI_LIKE_API_BASE_URL:"your_openai_like_base_url_here",PROD:!1,SSR:!1,TOGETHER_API_BASE_URL:"your_together_base_url_here",VITE_GITHUB_ACCESS_TOKEN:"",VITE_GITHUB_TOKEN_TYPE:"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",VITE_GITLAB_ACCESS_TOKEN:"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",VITE_GITLAB_TOKEN_TYPE:"personal-access-token",VITE_GITLAB_URL:"https://gitlab.com",VITE_LOG_LEVEL:"debug",VITE_NETLIFY_ACCESS_TOKEN:"your_netlify_access_token_here",VITE_SUPABASE_ACCESS_TOKEN:"your_supabase_access_token_here",VITE_SUPABASE_ANON_KEY:"your_supabase_anon_key_here",VITE_SUPABASE_URL:"your_supabase_project_url_here",VITE_USER_NODE_ENV:"development",VITE_VERCEL_ACCESS_TOKEN:"your_vercel_access_token_here"},Rl="project",rc=`/home/${Rl}`,nc=/^\[Model: (.*?)\]\n\n/,sc=/\[Provider: (.*?)\]\n\n/,ac="claude-3-5-sonnet-latest",ic="cachedPrompt",oc={APPROVE:"Yes, approved.",REJECT:"No, rejected."},lc="Error: No execute function found on tool",cc="Error: User denied access to tool execution",uc="Error: An error occured while calling tool",zs=Be.getInstance($l),Ol=zs.getAllProviders(),dc=zs.getDefaultProvider(),Bl={};Ol.forEach(t=>{Bl[t.name]={baseUrlKey:t.config.baseUrlKey,apiTokenKey:t.config.apiTokenKey}});const pc=[{name:"Expo App",label:"Expo App",description:"Expo starter template for building cross-platform mobile apps",githubRepo:"xKevIsDev/bolt-expo-template",tags:["mobile","expo","mobile-app","android","iphone"],icon:"i-bolt:expo"},{name:"Basic Astro",label:"Astro Basic",description:"Lightweight Astro starter template for building fast static websites",githubRepo:"xKevIsDev/bolt-astro-basic-template",tags:["astro","blog","performance"],icon:"i-bolt:astro"},{name:"NextJS Shadcn",label:"Next.js with shadcn/ui",description:"Next.js starter fullstack template integrated with shadcn/ui components and styling system",githubRepo:"xKevIsDev/bolt-nextjs-shadcn-template",tags:["nextjs","react","typescript","shadcn","tailwind"],icon:"i-bolt:nextjs"},{name:"Vite Shadcn",label:"Vite with shadcn/ui",description:"Vite starter fullstack template integrated with shadcn/ui components and styling system",githubRepo:"xKevIsDev/vite-shadcn",tags:["vite","react","typescript","shadcn","tailwind"],icon:"i-bolt:shadcn"},{name:"Qwik Typescript",label:"Qwik TypeScript",description:"Qwik framework starter with TypeScript for building resumable applications",githubRepo:"xKevIsDev/bolt-qwik-ts-template",tags:["qwik","typescript","performance","resumable"],icon:"i-bolt:qwik"},{name:"Remix Typescript",label:"Remix TypeScript",description:"Remix framework starter with TypeScript for full-stack web applications",githubRepo:"xKevIsDev/bolt-remix-ts-template",tags:["remix","typescript","fullstack","react"],icon:"i-bolt:remix"},{name:"Slidev",label:"Slidev Presentation",description:"Slidev starter template for creating developer-friendly presentations using Markdown",githubRepo:"xKevIsDev/bolt-slidev-template",tags:["slidev","presentation","markdown"],icon:"i-bolt:slidev"},{name:"Sveltekit",label:"SvelteKit",description:"SvelteKit starter template for building fast, efficient web applications",githubRepo:"bolt-sveltekit-template",tags:["svelte","sveltekit","typescript"],icon:"i-bolt:svelte"},{name:"Vanilla Vite",label:"Vanilla + Vite",description:"Minimal Vite starter template for vanilla JavaScript projects",githubRepo:"xKevIsDev/vanilla-vite-template",tags:["vite","vanilla-js","minimal"],icon:"i-bolt:vite"},{name:"Vite React",label:"React + Vite + typescript",description:"React starter template powered by Vite for fast development experience",githubRepo:"xKevIsDev/bolt-vite-react-ts-template",tags:["react","vite","frontend","website","app"],icon:"i-bolt:react"},{name:"Vite Typescript",label:"Vite + TypeScript",description:"Vite starter template with TypeScript configuration for type-safe development",githubRepo:"xKevIsDev/bolt-vite-ts-template",tags:["vite","typescript","minimal"],icon:"i-bolt:typescript"},{name:"Vue",label:"Vue.js",description:"Vue.js starter template with modern tooling and best practices",githubRepo:"xKevIsDev/bolt-vue-template",tags:["vue","typescript","frontend"],icon:"i-bolt:vue"},{name:"Angular",label:"Angular Starter",description:"A modern Angular starter template with TypeScript support and best practices configuration",githubRepo:"xKevIsDev/bolt-angular-template",tags:["angular","typescript","frontend","spa"],icon:"i-bolt:angular"},{name:"SolidJS",label:"SolidJS Tailwind",description:"Lightweight SolidJS starter template for building fast static websites",githubRepo:"xKevIsDev/solidjs-ts-tw",tags:["solidjs"],icon:"i-bolt:solidjs"}],hc=typeof navigator<"u"?navigator.platform.toLowerCase().includes("mac"):!1,fc=typeof navigator<"u"?navigator.platform.toLowerCase().includes("win"):!1,mc=typeof navigator<"u"?navigator.platform.toLowerCase().includes("linux"):!1;function gc(){return globalThis.innerWidth<640}export{jl as A,ga as B,pc as C,ac as D,dc as E,ic as F,nc as M,Ol as P,Fe as S,oc as T,rc as W,O as Z,N as a,Hl as b,Vi as c,Z as d,Y as e,es as f,zl as g,gc as h,ql as i,hc as j,fc as k,Gl as l,mc as m,Jl as n,I as o,Bl as p,Ga as q,ts as r,S as s,Rl as t,Mt as u,Ir as v,lc as w,cc as x,uc as y,sc as z};
